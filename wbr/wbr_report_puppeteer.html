<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WBR Business Vitals - Executive Report (PDF)</title>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.1/highcharts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.1/modules/exporting.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Base typography for PDF optimization */
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            font-size: 12pt;
            color: #333;
            margin: 20mm;
            line-height: 1.4;
            background-color: #fff;
        }
        
        h1, h2, h3 {
            font-weight: 600;
            color: #111;
            margin-top: 1em;
            margin-bottom: 0.5em;
            
        }
        


        /* Headers & footers for PDF */
        @page {
            margin: 20mm;
            @top-center { 
                content: "Eight Sleep WBR Report"; 
                font-size: 10pt;
                color: #666;
            }
            @bottom-center { 
                content: "Page " counter(page);
                font-size: 10pt;
                color: #666;
            }
        }

        .container {
            max-width: none;
            margin: 0;
            padding: 0;
        }

        .header {
            text-align: center;
            margin-bottom: 2em;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 1em;
            
        }

        .header h1 {
            font-size: 24pt;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5em;
        }

        .header .date-range {
            font-size: 14pt;
            color: #6b7280;
            font-weight: 500;
        }

        /* KPI Dashboard Grid - Optimized for PDF */
        .kpi-section {
            margin-bottom: 25px;
            
        }

        .kpi-section-header {
            font-size: 14pt;
            font-weight: 600;
            color: #374151;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .kpi-period-comparison {
            font-size: 12pt;
            color: #6b7280;
            font-weight: 500;
        }

        .kpi-dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 15px;
        }

        .kpi-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 12px;
            text-align: center;
            
        }

        .kpi-period {
            font-size: 10px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 4px;
        }

        .kpi-title {
            font-size: 11px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 6px;
        }

        .kpi-value {
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .kpi-change {
            font-size: 11px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
        }

        .change-positive {
            color: #059669;
        }

        .change-negative {
            color: #dc2626;
        }

        .change-neutral {
            color: #6b7280;
        }

        .arrow-up::before {
            content: "↑";
            margin-right: 2px;
        }

        .arrow-down::before {
            content: "↓";
            margin-right: 2px;
        }

        .arrow-flat::before {
            content: "→";
            margin-right: 2px;
        }

        /* Section Headers - Compressed */
        .section {
            margin-bottom: 15px;
            
        }

        .section-header {
            margin-bottom: 12px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .section-subtitle {
            font-size: 12px;
            color: #6b7280;
        }

        /* Chart containers - Fixed for PDF consistency */
        .chart-container {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 1em;
            margin: 1em 0;
            
            width: 100% !important;
            height: 400px !important;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .chart-full {
            grid-column: 1 / -1;
        }

        /* Executive Summary - Compressed */
        .executive-summary {
            background: #eff6ff;
            border-left: 3px solid #2563eb;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            
        }

        .executive-summary h3 {
            font-size: 14px;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .summary-points {
            list-style: none;
            padding: 0;
        }

        .summary-points li {
            padding: 2px 0;
            color: #1f2937;
            position: relative;
            padding-left: 15px;
            font-size: 11px;
            line-height: 1.3;
        }

        .summary-points li::before {
            content: "•";
            color: #2563eb;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        /* Forecast section - Compact */
        .forecast-grid {
            display: grid;
            grid-template-columns: 1fr 250px;
            gap: 15px;
            margin-top: 15px;
        }


        .scenario {
            display: flex;
            justify-content: space-between;
            padding: 3px 0;
            border-bottom: 1px solid #e5e7eb;
            font-size: 11px;
        }

        .scenario:last-child {
            border-bottom: none;
        }

        .scenario-spend {
            font-weight: 500;
            color: #374151;
        }

        .scenario-cac {
            font-weight: 600;
            color: #dc2626;
        }

        /* Page breaks for PDF */
        .page-break {
            page-break-before: always;
        }

        .no-break {
            /* Keeps content together */
        }

        /* Puppeteer-specific optimizations */
        body {
            margin: 15mm;
            font-size: 12pt;
        }
        
        .section {
            margin-bottom: 30px;
            padding-bottom: 20px;
        }
        
        .chart-container {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 20px;
            margin: 40px 0;
            width: 100%;
            max-width: 750px;
            min-height: 520px;
            height: auto;
            overflow: visible;
            clear: both;
        }
        
        /* Ensure all Highcharts containers render properly */
        .highcharts-container {
            width: 100% !important;
            height: 100% !important;
        }
        
        /* Forecast scenarios styling */
        .forecast-scenarios {
            background: #f9fafb;
            border-radius: 6px;
            padding: 12px;
            margin-top: 10px;
            font-size: 11pt;
        }
        
        .forecast-scenarios h4 {
            font-size: 12pt;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        /* Chart commentary styling */
        .chart-commentary {
            background: #f8fafc;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin-top: 25px;
            margin-bottom: 25px;
            font-size: 10pt;
            color: #4a5568;
            line-height: 1.4;
            clear: both;
        }

        .chart-commentary strong {
            color: #2d3748;
            font-weight: 600;
        }
    
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header no-break">
            <h1>Weekly Business Review - Business Vitals</h1>
            <div class="date-range" id="dateRange">8-Week Analysis Period</div>
        </div>

        <!-- KPI Dashboard -->
        <div class="kpi-section no-break">
            <div class="kpi-section-header">
                <span>Weekly Performance</span>
                <span class="kpi-period-comparison" id="weeklyComparison">Current Week vs Previous Week</span>
            </div>
            <div class="kpi-dashboard" id="weeklyKPIs">
                <!-- Weekly KPIs will be populated by JavaScript -->
            </div>
        </div>

        <div class="kpi-section no-break">
            <div class="kpi-section-header">
                <span>Monthly Performance</span>
                <span class="kpi-period-comparison" id="monthlyComparison">June 2025 vs May 2025</span>
            </div>
            <div class="kpi-dashboard" id="monthlyKPIs">
                <!-- Monthly KPIs will be populated by JavaScript -->
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="executive-summary no-break">
            <h3>Executive Summary</h3>
            <ul class="summary-points" id="executiveSummary">
                <!-- Summary points will be populated by JavaScript -->
            </ul>
        </div>

        <!-- Page Break: Start CAC Analysis -->
        <!-- Page break removed to prevent blank pages -->
        
        <!-- CAC Trends Section -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Customer Acquisition Cost Analysis</h2>
                <p class="section-subtitle">CAC trends, forecasting, and spend scenario modeling</p>
            </div>
            
            <div class="chart-container">
                <div id="weeklyCacChart" style="height: 420px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="weeklyCacCommentary"></div>
            </div>
            
            <div class="chart-container">
                <div id="monthlyCacChart" style="height: 420px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="monthlyCacCommentary"></div>
            </div>

            <div class="chart-container">
                <div id="forecastChart" style="height: 420px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="forecastCommentary"></div>
            </div>
            
            <div class="page-break"></div>
            <div class="forecast-scenarios no-break" id="forecastScenarios">
                <!-- Forecast scenarios will be populated by JavaScript -->
            </div>
        </div>

        <!-- Page Break: Start Regional Analysis -->
        <!-- Page break removed to prevent blank pages -->
        
        <!-- Regional Performance Section -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Regional Performance Overview</h2>
                <p class="section-subtitle">New customer acquisition by region with growth indicators</p>
            </div>
            
            <div class="chart-container">
                <div id="regionalOrdersChart" style="height: 420px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="regionalOrdersCommentary"></div>
            </div>
            
            <div class="chart-container">
                <div id="regionalGrowthChart" style="height: 420px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="regionalGrowthCommentary"></div>
            </div>
        </div>

        <!-- Page Break: Start Lifecycle & Forecast -->
        <!-- Page break removed to prevent blank pages -->
        
        <!-- Member Lifecycle Analysis Section -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Member Lifecycle Analysis</h2>
                <p class="section-subtitle">Customer behavior and retention trends</p>
            </div>
            
            <div class="chart-container">
                <div id="lifecycleChart" style="height: 420px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="lifecycleCommentary"></div>
            </div>
        </div>
    </div>

    <script>
        // Data will be loaded from the JSON file
        let reportData = {};

        // Number formatting functions
        function formatCurrency(value) {
            if (value >= 1000000) {
                return '$' + (value / 1000000).toFixed(1) + 'M';
            } else if (value >= 1000) {
                return '$' + (value / 1000).toFixed(0) + 'K';
            } else {
                return '$' + value.toFixed(0);
            }
        }

        function formatNumber(value) {
            if (typeof value === 'number') {
                return value.toLocaleString();
            }
            return value;
        }

        // Data embedded inline to avoid CORS issues
        function loadData() {
            reportData = {
  "current_week": {
    "period": "07/07 - 07/13",
    "spend": 678408.0,
    "orders": 859,
    "bookings": 3564795.0,
    "cac": 790
  },
  "previous_week": {
    "period": "06/30 - 07/06",
    "spend": 829136.0,
    "orders": 1097,
    "bookings": 4598045.0,
    "cac": 755.8213309024612
  },
  "current_month": {
    "period": "June 2025",
    "spend": 2699717.0,
    "orders": 3840,
    "bookings": 15674165.0,
    "cac": 703.0513020833333
  },
  "previous_month": {
    "period": "May 2025",
    "spend": 3437910.0,
    "orders": 4376,
    "bookings": 18411489.0,
    "cac": 785.6284277879342
  },
  "recent_weekly_cac": [
    {
      "week": "2025-W21",
      "spend": 720036.0,
      "orders": 1024,
      "bookings": 4407230.0,
      "cac": 703.16015625,
      "wow_change": -21.60459559779815
    },
    {
      "week": "2025-W22",
      "spend": 859426.0,
      "orders": 1140,
      "bookings": 4805253.0,
      "cac": 753.8824561403509,
      "wow_change": 7.213477532751034
    },
    {
      "week": "2025-W23",
      "spend": 648379.0,
      "orders": 901,
      "bookings": 3694730.0,
      "cac": 719.6215316315205,
      "wow_change": -4.544597666357153
    },
    {
      "week": "2025-W24",
      "spend": 580229.0,
      "orders": 777,
      "bookings": 3184211.0,
      "cac": 746.7554697554698,
      "wow_change": 3.7705845269014437
    },
    {
      "week": "2025-W25",
      "spend": 600446.0,
      "orders": 854,
      "bookings": 3425893.0,
      "cac": 703.0983606557377,
      "wow_change": -5.846238945397742
    },
    {
      "week": "2025-W26",
      "spend": 672387.0,
      "orders": 974,
      "bookings": 4024460.0,
      "cac": 690.3357289527721,
      "wow_change": -1.8151986147518007
    },
    {
      "week": "2025-W27",
      "spend": 829136.0,
      "orders": 1097,
      "bookings": 4598045.0,
      "cac": 755.8213309024612,
      "wow_change": 9.486051380975113
    },
    {
      "week": "2025-W28",
      "spend": 678408.0,
      "orders": 859,
      "bookings": 3564795.0,
      "cac": 789.7648428405122,
      "wow_change": 4.490943897749222
    }
  ],
  "monthly_cac": [
    {
      "month": "2024-08",
      "spend": 1893983.0,
      "orders": 3334,
      "bookings": 11646566.0,
      "cac": 568.0812837432513,
      "mom_change": -12.842331874140067
    },
    {
      "month": "2024-09",
      "spend": 1784066.0,
      "orders": 2815,
      "bookings": 9997755.0,
      "cac": 633.7712255772647,
      "mom_change": 11.563475811271818
    },
    {
      "month": "2024-10",
      "spend": 1504325.0,
      "orders": 2247,
      "bookings": 8241940.0,
      "cac": 669.4815309301291,
      "mom_change": 5.63457347252363
    },
    {
      "month": "2024-11",
      "spend": 2918373.0,
      "orders": 4834,
      "bookings": 17552907.0,
      "cac": 603.7180388911875,
      "mom_change": -9.82304798574124
    },
    {
      "month": "2024-12",
      "spend": 2007907.0,
      "orders": 4261,
      "bookings": 15342391.0,
      "cac": 471.2290542126261,
      "mom_change": -21.9455070320403
    },
    {
      "month": "2025-01",
      "spend": 1482448.0,
      "orders": 2273,
      "bookings": 8273662.0,
      "cac": 652.1988561372635,
      "mom_change": 38.40378692842248
    },
    {
      "month": "2025-02",
      "spend": 1545287.0,
      "orders": 2611,
      "bookings": 9271477.0,
      "cac": 591.8372271160475,
      "mom_change": -9.255095812144775
    },
    {
      "month": "2025-03",
      "spend": 1668573.0,
      "orders": 2789,
      "bookings": 9863277.0,
      "cac": 598.2692721405522,
      "mom_change": 1.0867929102478469
    },
    {
      "month": "2025-04",
      "spend": 1928805.0,
      "orders": 2917,
      "bookings": 10279102.0,
      "cac": 661.2290023997258,
      "mom_change": 10.523644317200098
    },
    {
      "month": "2025-05",
      "spend": 3437910.0,
      "orders": 4376,
      "bookings": 18411489.0,
      "cac": 785.6284277879342,
      "mom_change": 18.813364951739754
    },
    {
      "month": "2025-06",
      "spend": 2699717.0,
      "orders": 3840,
      "bookings": 15674165.0,
      "cac": 703.0513020833333,
      "mom_change": -10.510964571013604
    },
    {
      "month": "2025-07",
      "spend": 1398143.0,
      "orders": 1793,
      "bookings": 7506781.0,
      "cac": 779.7785833798104,
      "mom_change": 10.913468344218003
    }
  ],
  "regional_orders": {
    "regions": [
      "US",
      "EU",
      "GB",
      "CA",
      "MX",
      "AU",
      "CH",
      "ME",
      "Other"
    ],
    "orders": [
      5645,
      615,
      464,
      304,
      198,
      191,
      189,
      187,
      2
    ]
  },
  "regional_growth": [
    {
      "region": "AU",
      "growth": -32.16783216783217
    },
    {
      "region": "CA",
      "growth": -7.894736842105263
    },
    {
      "region": "CH",
      "growth": 19.791666666666664
    },
    {
      "region": "EU",
      "growth": -2.564102564102564
    },
    {
      "region": "GB",
      "growth": 17.2
    },
    {
      "region": "ME",
      "growth": -23.931623931623932
    },
    {
      "region": "MX",
      "growth": -61.111111111111114
    },
    {
      "region": "Other",
      "growth": -33.33333333333333
    },
    {
      "region": "US",
      "growth": -13.064259160913435
    }
  ],
  "forecast_scenarios": [
    {
      "spend_increase_pct": 10.0,
      "new_cac": 825,
      "cac_increase_pct": 4.0,
      "monthly_spend": 2046000,
      "additional_spend": 186000
    },
    {
      "spend_increase_pct": 20.0,
      "new_cac": 858,
      "cac_increase_pct": 8.2,
      "monthly_spend": 2232000,
      "additional_spend": 372000
    },
    {
      "spend_increase_pct": 30.0,
      "new_cac": 895,
      "cac_increase_pct": 12.9,
      "monthly_spend": 2418000,
      "additional_spend": 558000
    },
    {
      "spend_increase_pct": 50.0,
      "new_cac": 960,
      "cac_increase_pct": 21.1,
      "monthly_spend": 2790000,
      "additional_spend": 930000
    },
    {
      "spend_increase_pct": 100.0,
      "new_cac": 1190,
      "cac_increase_pct": 50.1,
      "monthly_spend": 3720000,
      "additional_spend": 1860000
    }
  ],
  "recent_summary": {
    "current_week_period": "July 07 - July 13, 2025",
    "current_month_name": "June 2025",
    "comparison_month_name": "May 2025",
    "latest_complete_week": "2025-07-13",
    "analysis_note": "June shows seasonal decline compared to May's traditional surge in sales performance"
  },
  "upgrades_renewals": {
    "upgrades": [
      {
        "date": "2025-06-15",
        "orders": 19,
        "bookings": 80456.0
      },
      {
        "date": "2025-06-16",
        "orders": 15,
        "bookings": 57916.0
      },
      {
        "date": "2025-06-17",
        "orders": 23,
        "bookings": 88186.0
      },
      {
        "date": "2025-06-18",
        "orders": 19,
        "bookings": 60339.0
      },
      {
        "date": "2025-06-19",
        "orders": 17,
        "bookings": 60946.0
      },
      {
        "date": "2025-06-20",
        "orders": 16,
        "bookings": 62700.0
      },
      {
        "date": "2025-06-21",
        "orders": 12,
        "bookings": 43851.0
      },
      {
        "date": "2025-06-22",
        "orders": 15,
        "bookings": 50125.0
      },
      {
        "date": "2025-06-23",
        "orders": 15,
        "bookings": 58579.0
      },
      {
        "date": "2025-06-24",
        "orders": 17,
        "bookings": 63864.0
      },
      {
        "date": "2025-06-25",
        "orders": 17,
        "bookings": 56831.0
      },
      {
        "date": "2025-06-26",
        "orders": 20,
        "bookings": 71547.0
      },
      {
        "date": "2025-06-27",
        "orders": 19,
        "bookings": 69226.0
      },
      {
        "date": "2025-06-28",
        "orders": 14,
        "bookings": 57053.0
      },
      {
        "date": "2025-06-29",
        "orders": 21,
        "bookings": 86697.0
      },
      {
        "date": "2025-06-30",
        "orders": 13,
        "bookings": 45506.0
      },
      {
        "date": "2025-07-01",
        "orders": 23,
        "bookings": 84630.0
      },
      {
        "date": "2025-07-02",
        "orders": 14,
        "bookings": 49836.0
      },
      {
        "date": "2025-07-03",
        "orders": 26,
        "bookings": 98995.0
      },
      {
        "date": "2025-07-04",
        "orders": 33,
        "bookings": 131373.0
      },
      {
        "date": "2025-07-05",
        "orders": 24,
        "bookings": 89918.0
      },
      {
        "date": "2025-07-06",
        "orders": 24,
        "bookings": 88354.0
      },
      {
        "date": "2025-07-07",
        "orders": 19,
        "bookings": 69653.0
      },
      {
        "date": "2025-07-08",
        "orders": 18,
        "bookings": 70462.0
      },
      {
        "date": "2025-07-09",
        "orders": 10,
        "bookings": 41555.0
      },
      {
        "date": "2025-07-10",
        "orders": 14,
        "bookings": 54280.0
      },
      {
        "date": "2025-07-11",
        "orders": 16,
        "bookings": 57860.0
      },
      {
        "date": "2025-07-12",
        "orders": 19,
        "bookings": 64376.0
      },
      {
        "date": "2025-07-13",
        "orders": 16,
        "bookings": 61866.0
      },
      {
        "date": "2025-07-14",
        "orders": 2,
        "bookings": 8337.0
      }
    ],
    "renewals": [
      {
        "date": "2025-06-15",
        "orders": 0,
        "bookings": 45711.0
      },
      {
        "date": "2025-06-16",
        "orders": 0,
        "bookings": 37457.0
      },
      {
        "date": "2025-06-17",
        "orders": 0,
        "bookings": 43863.0
      },
      {
        "date": "2025-06-18",
        "orders": 0,
        "bookings": 40343.0
      },
      {
        "date": "2025-06-19",
        "orders": 0,
        "bookings": 54044.0
      },
      {
        "date": "2025-06-20",
        "orders": 0,
        "bookings": 51239.0
      },
      {
        "date": "2025-06-21",
        "orders": 0,
        "bookings": 34168.0
      },
      {
        "date": "2025-06-22",
        "orders": 0,
        "bookings": 42735.0
      },
      {
        "date": "2025-06-23",
        "orders": 0,
        "bookings": 42392.0
      },
      {
        "date": "2025-06-24",
        "orders": 0,
        "bookings": 39991.0
      },
      {
        "date": "2025-06-25",
        "orders": 0,
        "bookings": 44732.0
      },
      {
        "date": "2025-06-26",
        "orders": 0,
        "bookings": 47177.0
      },
      {
        "date": "2025-06-27",
        "orders": 0,
        "bookings": 43670.0
      },
      {
        "date": "2025-06-28",
        "orders": 0,
        "bookings": 47563.0
      },
      {
        "date": "2025-06-29",
        "orders": 0,
        "bookings": 44719.0
      },
      {
        "date": "2025-06-30",
        "orders": 0,
        "bookings": 45054.0
      },
      {
        "date": "2025-07-01",
        "orders": 0,
        "bookings": 53204.0
      },
      {
        "date": "2025-07-02",
        "orders": 0,
        "bookings": 54943.0
      },
      {
        "date": "2025-07-03",
        "orders": 0,
        "bookings": 54877.0
      },
      {
        "date": "2025-07-04",
        "orders": 0,
        "bookings": 69623.0
      },
      {
        "date": "2025-07-05",
        "orders": 0,
        "bookings": 48249.0
      },
      {
        "date": "2025-07-06",
        "orders": 0,
        "bookings": 54892.0
      },
      {
        "date": "2025-07-07",
        "orders": 0,
        "bookings": 111069.0
      },
      {
        "date": "2025-07-08",
        "orders": 0,
        "bookings": 92811.0
      },
      {
        "date": "2025-07-09",
        "orders": 0,
        "bookings": 89205.0
      },
      {
        "date": "2025-07-10",
        "orders": 0,
        "bookings": 83930.0
      },
      {
        "date": "2025-07-11",
        "orders": 0,
        "bookings": 70077.0
      },
      {
        "date": "2025-07-12",
        "orders": 0,
        "bookings": 54014.0
      },
      {
        "date": "2025-07-13",
        "orders": 0,
        "bookings": 57102.0
      },
      {
        "date": "2025-07-14",
        "orders": 0,
        "bookings": 16409.0
      }
    ]
  }
};
            initializeReport();
        }

        function initializeReport() {
            updateDateRange();
            populateKPIDashboard();
            populateExecutiveSummary();
            createWeeklyCACChart();
            createMonthlyCACChart();
            createRegionalCharts();
            createLifecycleChart();
            createForecastChart();
            populateForecastScenarios();
            populateChartCommentary();
        }

        function updateDateRange() {
            const summary = reportData.recent_summary;
            if (summary) {
                document.getElementById('dateRange').textContent = 
                    `Current Analysis Week: ${summary.current_week_period}`;
                
                // Update period comparisons
                if (reportData.current_week && reportData.previous_week) {
                    document.getElementById('weeklyComparison').textContent = 
                        `${reportData.current_week.period} vs ${reportData.previous_week.period}`;
                }
            }
        }

        function populateKPIDashboard() {
            populateWeeklyKPIs();
            populateMonthlyKPIs();
        }

        function populateWeeklyKPIs() {
            const weeklyDashboard = document.getElementById('weeklyKPIs');
            const currentWeek = reportData.current_week;
            const previousWeek = reportData.previous_week;
            
            if (!currentWeek || !previousWeek) return;

            // Calculate weekly changes
            const ordersChange = ((currentWeek.orders - previousWeek.orders) / previousWeek.orders * 100);
            const bookingsChange = ((currentWeek.bookings - previousWeek.bookings) / previousWeek.bookings * 100);
            const spendChange = ((currentWeek.spend - previousWeek.spend) / previousWeek.spend * 100);
            const cacChange = ((currentWeek.cac - previousWeek.cac) / previousWeek.cac * 100);

            const weeklyKPIs = [
                {
                    title: 'New Customers',
                    value: currentWeek.orders.toLocaleString(),
                    change: ordersChange
                },
                {
                    title: 'Booking Revenue',
                    value: formatCurrency(currentWeek.bookings),
                    change: bookingsChange
                },
                {
                    title: 'Marketing Spend',
                    value: formatCurrency(currentWeek.spend),
                    change: spendChange
                },
                {
                    title: 'CAC',
                    value: '$' + Math.round(currentWeek.cac),
                    change: cacChange
                }
            ];

            weeklyDashboard.innerHTML = weeklyKPIs.map(kpi => createKPICard(kpi)).join('');
        }

        function populateMonthlyKPIs() {
            const monthlyDashboard = document.getElementById('monthlyKPIs');
            const currentMonth = reportData.current_month;
            const previousMonth = reportData.previous_month;
            
            if (!currentMonth || !previousMonth) return;

            // Calculate monthly changes
            const ordersChange = ((currentMonth.orders - previousMonth.orders) / previousMonth.orders * 100);
            const bookingsChange = ((currentMonth.bookings - previousMonth.bookings) / previousMonth.bookings * 100);
            const spendChange = ((currentMonth.spend - previousMonth.spend) / previousMonth.spend * 100);
            const cacChange = ((currentMonth.cac - previousMonth.cac) / previousMonth.cac * 100);

            const monthlyKPIs = [
                {
                    title: 'New Customers',
                    value: currentMonth.orders.toLocaleString(),
                    change: ordersChange
                },
                {
                    title: 'Booking Revenue',
                    value: formatCurrency(currentMonth.bookings),
                    change: bookingsChange
                },
                {
                    title: 'Marketing Spend',
                    value: formatCurrency(currentMonth.spend),
                    change: spendChange
                },
                {
                    title: 'CAC',
                    value: '$' + Math.round(currentMonth.cac),
                    change: cacChange
                }
            ];

            monthlyDashboard.innerHTML = monthlyKPIs.map(kpi => createKPICard(kpi)).join('');
        }

        function createKPICard(kpi) {
            const changeClass = kpi.change > 2 ? 'change-positive' : 
                               kpi.change < -2 ? 'change-negative' : 'change-neutral';
            const arrowClass = kpi.change > 2 ? 'arrow-up' : 
                              kpi.change < -2 ? 'arrow-down' : 'arrow-flat';
            
            return `
                <div class="kpi-card">
                    <div class="kpi-title">${kpi.title}</div>
                    <div class="kpi-value">${kpi.value}</div>
                    <div class="kpi-change ${changeClass}">
                        <span class="${arrowClass}">${Math.abs(kpi.change).toFixed(1)}%</span>
                    </div>
                </div>
            `;
        }

        function populateExecutiveSummary() {
            const summary = document.getElementById('executiveSummary');
            const currentWeek = reportData.current_week;
            const currentMonth = reportData.current_month;
            const previousMonth = reportData.previous_month;
            const regionalData = reportData.regional_orders;
            
            if (!currentWeek || !currentMonth) return;
            
            const monthlyOrdersDecline = ((currentMonth.orders - previousMonth.orders) / previousMonth.orders * 100);
            const topRegion = regionalData.regions[0];
            
            const summaryPoints = [
                `${reportData.recent_summary.analysis_note}`,
                `Current week (${currentWeek.period}) acquired ${currentWeek.orders.toLocaleString()} new customers at $${Math.round(currentWeek.cac)} CAC`,
                `June performance down ${Math.abs(monthlyOrdersDecline).toFixed(1)}% vs May due to seasonal patterns following May's traditional sales surge`,
                `${topRegion} maintains market leadership with ${((regionalData.orders[0] / regionalData.orders.reduce((a,b) => a + b, 0)) * 100).toFixed(0)}% of new customer acquisition`
            ];

            summary.innerHTML = summaryPoints.map(point => `<li>${point}</li>`).join('');
        }

        function createWeeklyCACChart() {
            const weeklyData = reportData.recent_weekly_cac;
            if (!weeklyData) return;

            Highcharts.chart('weeklyCacChart', {
                chart: { 
                    type: 'line', 
                    height: 430,
                    width: 700
                },
                title: { text: 'Weekly CAC Trend (WoW %)', style: { fontSize: '13px' } },
                xAxis: {
                    categories: weeklyData.map(d => d.week),
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: [
                    {
                        title: { text: 'CAC ($)', style: { fontSize: '10px', color: '#e74c3c' } },
                        labels: { style: { fontSize: '10px', color: '#e74c3c' } }
                    },
                    {
                        title: { text: 'WoW %', style: { fontSize: '10px', color: '#3498db' } },
                        labels: { style: { fontSize: '10px', color: '#3498db' } },
                        opposite: true
                    }
                ],
                series: [
                    {
                        name: 'CAC',
                        data: weeklyData.map(d => Math.round(d.cac)),
                        color: '#e74c3c',
                        yAxis: 0,
                        lineWidth: 2,
                        marker: { radius: 3 }
                    },
                    {
                        name: 'WoW %',
                        data: weeklyData.map(d => d.wow_change),
                        color: '#3498db',
                        yAxis: 1,
                        type: 'column',
                        opacity: 0.3
                    }
                ],
                legend: { enabled: true, itemStyle: { fontSize: '10px' } },
                credits: { enabled: false }
            });
        }

        function createMonthlyCACChart() {
            const monthlyData = reportData.monthly_cac.slice(-12);
            if (!monthlyData) return;

            Highcharts.chart('monthlyCacChart', {
                chart: { 
                    type: 'column', 
                    height: 430,
                    width: 700
                },
                title: { text: 'Monthly CAC History (MoM %)', style: { fontSize: '13px' } },
                xAxis: {
                    categories: monthlyData.map(d => d.month.substring(0, 7)),
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'CAC ($)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Monthly CAC',
                    data: monthlyData.map(d => ({
                        y: Math.round(d.cac),
                        color: d.mom_change > 0 ? '#e74c3c' : '#27ae60'
                    }))
                }],
                legend: { enabled: false },
                plotOptions: {
                    column: {
                        dataLabels: {
                            enabled: true,
                            format: '${point.y}',
                            style: { fontSize: '9px' }
                        }
                    }
                },
                credits: { enabled: false }
            });
        }

        function createRegionalCharts() {
            const regionalData = reportData.regional_orders;
            const growthData = reportData.regional_growth;
            
            // Regional Orders Chart
            Highcharts.chart('regionalOrdersChart', {
                chart: { 
                    type: 'bar', 
                    height: 430,
                    width: 700
                },
                title: { text: 'Orders by Region (Current Period)', style: { fontSize: '13px' } },
                xAxis: {
                    categories: regionalData.regions,
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'Orders', style: { fontSize: '10px' } },
                    labels: { 
                        style: { fontSize: '10px' },
                        formatter: function() { return formatNumber(this.value); }
                    }
                },
                series: [{
                    name: 'Orders',
                    data: regionalData.orders,
                    color: '#3498db',
                    dataLabels: {
                        enabled: true,
                        formatter: function() { return formatNumber(this.y); },
                        style: { fontSize: '9px' }
                    }
                }],
                legend: { enabled: false },
                credits: { enabled: false }
            });

            // Regional Growth Chart
            if (growthData && growthData.length > 0) {
                Highcharts.chart('regionalGrowthChart', {
                    chart: { 
                    type: 'column', 
                    height: 430,
                    width: 700
                },
                    title: { text: 'Regional Growth (% Change)', style: { fontSize: '13px' } },
                    xAxis: {
                        categories: growthData.map(d => d.region),
                        labels: { style: { fontSize: '10px' } }
                    },
                    yAxis: {
                        title: { text: 'Growth %', style: { fontSize: '10px' } },
                        labels: { style: { fontSize: '10px' } },
                        plotLines: [{ value: 0, color: '#666', width: 1 }]
                    },
                    series: [{
                        name: 'Growth',
                        data: growthData.map(d => ({
                            y: d.growth,
                            color: d.growth > 0 ? '#27ae60' : '#e74c3c'
                        })),
                        dataLabels: {
                            enabled: true,
                            format: '{point.y:.1f}%',
                            style: { fontSize: '9px' }
                        }
                    }],
                    legend: { enabled: false },
                    credits: { enabled: false }
                });
            }
        }

        function createLifecycleChart() {
            const upgradesData = reportData.upgrades_renewals?.upgrades || [];
            const renewalsData = reportData.upgrades_renewals?.renewals || [];
            
            if (upgradesData.length === 0) return;

            const dates = upgradesData.map(d => d.date);
            
            Highcharts.chart('lifecycleChart', {
                chart: { 
                    type: 'line', 
                    height: 430,
                    width: 700
                },
                title: { text: 'Member Upgrades vs Renewals Bookings (Weekly Trend)', style: { fontSize: '13px' } },
                xAxis: {
                    categories: dates.map(d => d.substring(5)),
                    labels: { style: { fontSize: '9px' } },
                    tickInterval: Math.floor(dates.length / 4)
                },
                yAxis: {
                    title: { text: 'Bookings ($)', style: { fontSize: '10px' } },
                    labels: { 
                        style: { fontSize: '10px' },
                        formatter: function() {
                            return formatCurrency(this.value);
                        }
                    }
                },
                series: [
                    {
                        name: 'Upgrade Bookings',
                        data: upgradesData.map(d => d.bookings),
                        color: '#9b59b6',
                        lineWidth: 2
                    },
                    {
                        name: 'Renewal Bookings',
                        data: renewalsData.map(d => d.bookings),
                        color: '#34495e',
                        lineWidth: 2
                    }
                ],
                legend: { enabled: true, itemStyle: { fontSize: '10px' } },
                credits: { enabled: false },
                tooltip: {
                    formatter: function() {
                        return '<b>' + this.series.name + '</b><br>' +
                               this.x + ': ' + formatCurrency(this.y);
                    }
                }
            });
        }

        function createForecastChart() {
            const forecastData = reportData.forecast_scenarios;
            if (!forecastData) return;

            Highcharts.chart('forecastChart', {
                chart: { 
                    type: 'line', 
                    height: 430,
                    width: 700
                },
                title: { text: 'CAC Forecast Model (Spend Scenarios)', style: { fontSize: '13px' } },
                subtitle: { text: 'Diminishing returns scenarios', style: { fontSize: '11px' } },
                xAxis: {
                    title: { text: 'Spend Increase', style: { fontSize: '10px' } },
                    categories: forecastData.map(d => d.spend_increase_pct + '%'),
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'CAC ($)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Predicted CAC',
                    data: forecastData.map(d => Math.round(d.new_cac)),
                    color: '#e67e22',
                    lineWidth: 3,
                    marker: { radius: 4 },
                    dataLabels: {
                        enabled: true,
                        format: '${point.y}',
                        style: { fontSize: '9px' }
                    }
                }],
                legend: { enabled: false },
                credits: { enabled: false }
            });
        }

        function populateChartCommentary() {
            populateWeeklyCacCommentary();
            populateMonthlyCacCommentary();
            populateForecastCommentary();
            populateRegionalCommentary();
            populateLifecycleCommentary();
        }

        function populateWeeklyCacCommentary() {
            const commentary = document.getElementById('weeklyCacCommentary');
            const weeklyData = reportData.recent_weekly_cac;
            
            if (weeklyData && weeklyData.length >= 2) {
                const latestWeek = weeklyData[weeklyData.length - 1];
                const previousWeek = weeklyData[weeklyData.length - 2];
                const change = ((latestWeek.cac - previousWeek.cac) / previousWeek.cac * 100);
                const trend = change > 0 ? 'increased' : 'decreased';
                
                commentary.innerHTML = `<strong>Week-over-Week Trend:</strong> CAC ${trend} by ${Math.abs(change).toFixed(1)}% from $${Math.round(previousWeek.cac)} to $${Math.round(latestWeek.cac)}. ${change > 5 ? 'Rising CAC indicates increasing competition or channel saturation.' : change < -5 ? 'Decreasing CAC suggests improved efficiency or better targeting.' : 'CAC remains relatively stable.'}`;
            }
        }

        function populateMonthlyCacCommentary() {
            const commentary = document.getElementById('monthlyCacCommentary');
            const monthlyData = reportData.monthly_cac;
            
            if (monthlyData && monthlyData.length >= 2) {
                const latest = monthlyData[monthlyData.length - 1];
                const previous = monthlyData[monthlyData.length - 2];
                const change = ((latest.cac - previous.cac) / previous.cac * 100);
                const trend = change > 0 ? 'increased' : 'decreased';
                
                commentary.innerHTML = `<strong>Monthly Trend:</strong> CAC ${trend} by ${Math.abs(change).toFixed(1)}% month-over-month. Historical data shows ${monthlyData.length} months of CAC performance with average of $${Math.round(monthlyData.reduce((sum, d) => sum + d.cac, 0) / monthlyData.length)}.`;
            }
        }

        function populateForecastCommentary() {
            const commentary = document.getElementById('forecastCommentary');
            const forecastData = reportData.forecast_scenarios;
            
            if (forecastData) {
                const baselineCAC = 793; // Current 8-week average
                const maxCAC = 1190; // 100% increase scenario
                const efficiency = ((maxCAC - baselineCAC) / baselineCAC * 100);
                const optimalScenario = forecastData.find(d => d.spend_increase_pct === 30);
                
                commentary.innerHTML = `<strong>Diminishing Returns Analysis:</strong> Doubling spend increases CAC by ${efficiency.toFixed(1)}% to $${maxCAC}, showing typical market saturation effects. Optimal spend increase appears to be 20-30% range (+$${(optimalScenario.additional_spend/1000).toFixed(0)}K/month) for balanced growth efficiency.`;
            }
        }

        function populateRegionalCommentary() {
            const ordersCommentary = document.getElementById('regionalOrdersCommentary');
            const growthCommentary = document.getElementById('regionalGrowthCommentary');
            const regionalData = reportData.regional_orders;
            const growthData = reportData.regional_growth;
            
            if (regionalData && regionalData.orders) {
                const totalOrders = regionalData.orders.reduce((sum, orders) => sum + orders, 0);
                const usShare = (regionalData.orders[0] / totalOrders * 100).toFixed(0);
                
                ordersCommentary.innerHTML = `<strong>Market Dominance:</strong> US drives ${usShare}% of total orders (${formatNumber(regionalData.orders[0])} of ${formatNumber(totalOrders)}). EU and GB represent the next largest markets with ${formatNumber(regionalData.orders[1])} and ${formatNumber(regionalData.orders[2])} orders respectively.`;
            }
            
            if (growthData && Array.isArray(growthData)) {
                const growthRates = growthData.map(d => d.growth);
                const regions = growthData.map(d => d.region);
                const bestPerformer = Math.max(...growthRates);
                const worstPerformer = Math.min(...growthRates);
                const bestIndex = growthRates.indexOf(bestPerformer);
                const worstIndex = growthRates.indexOf(worstPerformer);
                
                growthCommentary.innerHTML = `<strong>Regional Growth:</strong> ${regions[bestIndex]} leads growth at +${bestPerformer.toFixed(1)}%, while ${regions[worstIndex]} shows ${worstPerformer.toFixed(1)}% decline. ${growthRates.filter(r => r > 0).length} of ${regions.length} regions show positive growth.`;
            }
        }

        function populateLifecycleCommentary() {
            const commentary = document.getElementById('lifecycleCommentary');
            const lifecycleData = reportData.upgrades_renewals;
            
            if (lifecycleData && lifecycleData.upgrades && lifecycleData.renewals) {
                const totalUpgradeBookings = lifecycleData.upgrades.reduce((sum, item) => sum + (item.bookings || 0), 0);
                const totalRenewalBookings = lifecycleData.renewals.reduce((sum, item) => sum + (item.bookings || 0), 0);
                const upgradeBookingsShare = (totalUpgradeBookings / (totalUpgradeBookings + totalRenewalBookings) * 100);
                
                const latestUpgradeBookings = lifecycleData.upgrades[lifecycleData.upgrades.length - 1]?.bookings || 0;
                const latestRenewalBookings = lifecycleData.renewals[lifecycleData.renewals.length - 1]?.bookings || 0;
                
                commentary.innerHTML = `<strong>Revenue Mix:</strong> ${upgradeBookingsShare.toFixed(1)}% of lifecycle revenue comes from upgrades vs renewals (${formatCurrency(totalUpgradeBookings)} vs ${formatCurrency(totalRenewalBookings)}). Latest period shows ${formatCurrency(latestUpgradeBookings)} in upgrade bookings and ${formatCurrency(latestRenewalBookings)} in renewals, indicating ${latestUpgradeBookings > latestRenewalBookings ? 'strong upselling momentum driving higher-value customers' : 'focus on retention over expansion revenue'}.`;
            }
        }

        function populateForecastScenarios() {
            const scenarios = document.getElementById('forecastScenarios');
            const forecastData = reportData.forecast_scenarios;
            
            if (!forecastData) return;

            scenarios.innerHTML = `
                <h4>Scenario Analysis</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; font-size: 10px; font-weight: 600; color: #374151; border-bottom: 1px solid #e5e7eb; padding-bottom: 4px; margin-bottom: 6px;">
                    <div>Spend Increase</div>
                    <div>Monthly Spend</div>
                    <div>Additional Spend</div>
                    <div>New CAC</div>
                </div>
                ${forecastData.map(d => `
                    <div class="scenario" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; align-items: center;">
                        <span class="scenario-spend">+${d.spend_increase_pct}%</span>
                        <span style="font-size: 10px; color: #4b5563;">$${(d.monthly_spend / 1000000).toFixed(2)}M</span>
                        <span style="font-size: 10px; color: #059669; font-weight: 500;">+$${(d.additional_spend / 1000).toFixed(0)}K</span>
                        <span class="scenario-cac">$${Math.round(d.new_cac)}</span>
                    </div>
                `).join('')}
                <div style="margin-top: 8px; font-size: 10px; color: #6b7280;">
                    <strong>Methodology:</strong> Based on historical channel elasticity with diminishing returns
                </div>
            `;
        }

        // Initialize sample data for fallback
        function initializeWithSampleData() {
            reportData = {
                recent_weekly_cac: [
                    {week: '2025-W20', spend: 400000, orders: 520, bookings: 2800000, cac: 769, wow_change: -5.2},
                    {week: '2025-W21', spend: 410000, orders: 510, bookings: 2750000, cac: 804, wow_change: 4.5},
                    {week: '2025-W22', spend: 395000, orders: 530, bookings: 2900000, cac: 745, wow_change: -7.3},
                    {week: '2025-W23', spend: 420000, orders: 540, bookings: 3100000, cac: 778, wow_change: 4.4},
                    {week: '2025-W24', spend: 435000, orders: 525, bookings: 2950000, cac: 829, wow_change: 6.6},
                    {week: '2025-W25', spend: 445000, orders: 535, bookings: 3050000, cac: 832, wow_change: 0.4},
                    {week: '2025-W26', spend: 430000, orders: 548, bookings: 3200000, cac: 784, wow_change: -5.8},
                    {week: '2025-W27', spend: 440000, orders: 555, bookings: 3150000, cac: 793, wow_change: 1.1}
                ],
                monthly_cac: [
                    {month: '2024-08', spend: 1650000, orders: 2100, bookings: 12500000, cac: 786, mom_change: -2.1},
                    {month: '2024-09', spend: 1720000, orders: 2150, bookings: 13200000, cac: 800, mom_change: 1.8},
                    {month: '2024-10', spend: 1680000, orders: 2080, bookings: 12800000, cac: 808, mom_change: 1.0},
                    {month: '2024-11', spend: 1750000, orders: 2200, bookings: 13800000, cac: 795, mom_change: -1.6},
                    {month: '2024-12', spend: 1820000, orders: 2320, bookings: 14500000, cac: 784, mom_change: -1.4},
                    {month: '2025-01', spend: 1780000, orders: 2280, bookings: 14200000, cac: 781, mom_change: -0.4},
                    {month: '2025-02', spend: 1650000, orders: 2050, bookings: 12800000, cac: 805, mom_change: 3.1},
                    {month: '2025-03', spend: 1720000, orders: 2180, bookings: 13600000, cac: 789, mom_change: -2.0},
                    {month: '2025-04', spend: 1690000, orders: 2140, bookings: 13200000, cac: 790, mom_change: 0.1},
                    {month: '2025-05', spend: 1750000, orders: 2250, bookings: 14100000, cac: 778, mom_change: -1.5},
                    {month: '2025-06', spend: 1830000, orders: 2320, bookings: 14800000, cac: 789, mom_change: 1.4},
                    {month: '2025-07', spend: 875000, orders: 1103, bookings: 6350000, cac: 793, mom_change: 0.5}
                ],
                regional_orders: {
                    regions: ['US', 'CA', 'AU', 'GB', 'EU', 'Other'],
                    orders: [8540, 1250, 980, 650, 420, 160]
                },
                regional_growth: [
                    {region: 'US', growth: 8.2},
                    {region: 'CA', growth: 12.5},
                    {region: 'AU', growth: -3.1},
                    {region: 'GB', growth: 15.8},
                    {region: 'EU', growth: 5.2},
                    {region: 'Other', growth: -8.5}
                ],
                forecast_scenarios: [
                    {spend_increase_pct: 10, new_cac: 825, cac_increase_pct: 4.0, monthly_spend: 2046000, additional_spend: 186000},
                    {spend_increase_pct: 20, new_cac: 858, cac_increase_pct: 8.2, monthly_spend: 2232000, additional_spend: 372000},
                    {spend_increase_pct: 30, new_cac: 895, cac_increase_pct: 12.9, monthly_spend: 2418000, additional_spend: 558000},
                    {spend_increase_pct: 50, new_cac: 960, cac_increase_pct: 21.1, monthly_spend: 2790000, additional_spend: 930000},
                    {spend_increase_pct: 100, new_cac: 1190, cac_increase_pct: 50.1, monthly_spend: 3720000, additional_spend: 1860000}
                ],
                recent_summary: {
                    avg_cac: 793,
                    eight_weeks_ago: '2025-05-18',
                    latest_date: '2025-07-13'
                },
                upgrades_renewals: {
                    upgrades: Array.from({length: 30}, (_, i) => ({
                        date: new Date(2025, 5, i + 1).toISOString().split('T')[0],
                        orders: Math.floor(Math.random() * 5) + 3,
                        bookings: Math.floor(Math.random() * 15000) + 10000
                    })),
                    renewals: Array.from({length: 30}, (_, i) => ({
                        date: new Date(2025, 5, i + 1).toISOString().split('T')[0],
                        orders: Math.floor(Math.random() * 3) + 1,
                        bookings: Math.floor(Math.random() * 8000) + 5000
                    }))
                }
            };
            
            initializeReport();
        }

        // Load data when page loads
        loadData();
    </script>
</body>
</html>