<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eight Sleep Marketing Performance Report</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/funnel.js"></script>
    <script src="https://code.highcharts.com/modules/heatmap.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #2C3E50;
            background-color: #FAFBFC;
            padding: 20px 10px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            padding: 40px;
        }

        h1 {
            font-size: 32px;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 16px;
            color: #95A5A6;
            margin-bottom: 40px;
        }

        h2 {
            font-size: 24px;
            font-weight: 600;
            color: #2C3E50;
            margin-top: 35px;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #ECF0F1;
        }

        .executive-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .executive-summary h2 {
            color: white;
            border: none;
            margin-top: 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ECF0F1;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 28px;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 14px;
            color: #95A5A6;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-change {
            font-size: 14px;
            margin-top: 8px;
        }

        .positive {
            color: #27AE60;
        }

        .negative {
            color: #E74C3C;
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ECF0F1;
        }

        .insights-list {
            list-style: none;
            padding: 0;
        }

        .insights-list li {
            padding: 15px 0;
            border-bottom: 1px solid #ECF0F1;
            display: flex;
            align-items: flex-start;
        }

        .insights-list li:last-child {
            border-bottom: none;
        }

        .insight-icon {
            width: 24px;
            height: 24px;
            background: #3498DB;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .alert-box {
            background: #FEF5E7;
            border-left: 4px solid #F39C12;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .alert-box h3 {
            color: #E67E22;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .recommendation-card {
            background: #EBF5FB;
            border-left: 4px solid #3498DB;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .recommendation-card h4 {
            color: #2874A6;
            margin-bottom: 10px;
        }

        .data-needs {
            background: #F8F9FA;
            padding: 25px;
            border-radius: 8px;
            margin: 30px 0;
        }

        .data-needs ul {
            margin-left: 20px;
            margin-top: 15px;
        }

        .data-needs li {
            margin-bottom: 10px;
            color: #5D6D7E;
        }

        @media print {
            body {
                padding: 0;
                background: white;
            }

            .container {
                box-shadow: none;
                padding: 20px;
            }

            .chart-container {
                page-break-inside: avoid;
            }

            h2 {
                page-break-after: avoid;
            }
        }

        .highcharts-figure {
            min-height: 400px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Eight Sleep Marketing Performance Report</h1>
        <p class="subtitle">18-Month Analysis | Data-Driven Insights for Strategic Growth</p>

        <div class="executive-summary">
            <h2>Executive Summary - Attribution-Aware Analysis</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">$12.3M</div>
                    <div class="metric-label">Total Marketing Spend</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$46.3M</div>
                    <div class="metric-label">Total Revenue</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$1,298</div>
                    <div class="metric-label">Blended CAC</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">4.52x</div>
                    <div class="metric-label">Overall ROAS</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">+$4.6M</div>
                    <div class="metric-label">Revenue Opportunity</div>
                </div>
            </div>
            <ul class="insights-list" style="margin-top: 30px;">
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">üö®</span>
                    <span><strong>Attribution Discovery:</strong> 0.72 correlation between YouTube spend and Google orders - YouTube drives Google's 4.57x ROAS</span>
                </li>
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">üìä</span>
                    <span><strong>Seasonality Impact:</strong> Q4 revenue 30-40% above baseline, May spring peak, Q1 requires budget reduction</span>
                </li>
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">üìâ</span>
                    <span><strong>CAC Trends:</strong> FB Ads CAC improved 30% YoY, Google stable at ~$1K, YouTube volatile ($1.3K-$4.7K)</span>
                </li>
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">üìß</span>
                    <span><strong>Growth Opportunity:</strong> Double YouTube email capture rate (5.8% ‚Üí 12%) could add $4.6M revenue</span>
                </li>
            </ul>
        </div>

        <h2>Channel Performance Trends</h2>
        
        <div class="chart-container">
            <div id="revenue-trends-chart" class="highcharts-figure"></div>
        </div>

        <div class="chart-container">
            <div id="channel-comparison-chart" class="highcharts-figure"></div>
        </div>

        <h2>Key Findings & Attribution Analysis</h2>
        
        <div class="alert-box">
            <h3>üö® Critical Attribution Discovery</h3>
            <p><strong>Finding:</strong> Google Ads performance is heavily dependent on YouTube awareness investment.</p>
            <p><strong>Evidence:</strong> When YouTube spend >$300K, Google revenue averages $3.9M. When <$50K, Google averages $2.0M.</p>
            <p><strong>Impact:</strong> Google's "4.57x ROAS" includes $1.9M lift from YouTube that YouTube doesn't get credit for.</p>
            <p><strong>Strategic Implication:</strong> Can't scale Google Ads without maintaining YouTube awareness support.</p>
        </div>

        <h3>Attribution Evidence - YouTube Drives Google Performance</h3>
        <div class="chart-container">
            <div id="youtube-google-correlation" class="highcharts-figure"></div>
        </div>
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #27AE60;">üìà</span>
                <div>
                    <strong>Strong Correlation:</strong> 0.72 correlation between YouTube spend and Google conversions with 1-month lag effect.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #3498DB;">üîç</span>
                <div>
                    <strong>May 2025 Peak:</strong> $811K YouTube investment drove 860 Google orders - the highest conversion month.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">üí°</span>
                <div>
                    <strong>Attribution Reality:</strong> Google appears efficient because it harvests demand YouTube creates but doesn't get credit for.
                </div>
            </li>
        </div>

        <ul class="insights-list">
            <li>
                <span class="insight-icon" style="background: #3498DB;">üéØ</span>
                <div>
                    <strong>Channel Strategy:</strong> YouTube + FB Ads (37% of total spend) can be directly scaled. Focus optimization efforts on these channels for maximum impact.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">üìß</span>
                <div>
                    <strong>YouTube Email Opportunity:</strong> Current 5.8% email capture rate with 0.59% email‚Üísale conversion. Doubling capture rate could generate +$4.6M annual revenue through extended nurture sequences.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #E74C3C;">üîç</span>
                <div>
                    <strong>Data Quality Localized:</strong> 89% of cart/order anomalies occur in Organic+Direct (subscription renewals, saved payments). Paid channel attribution is reliable for decision-making.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">üìä</span>
                <div>
                    <strong>FB Ads Underinvested:</strong> Shows true 2.86x ROAS with no attribution bias. Currently only 26% of controllable spend despite superior direct response performance.
                </div>
            </li>
        </ul>

        <div class="chart-container">
            <div id="funnel-analysis-chart" class="highcharts-figure"></div>
        </div>

        <h2>Customer Acquisition Cost (CAC) Analysis</h2>
        
        <div class="chart-container">
            <div id="cac-analysis-chart" class="highcharts-figure"></div>
        </div>
        
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #27AE60;">1</span>
                <div>
                    <strong>Google Ads - Most Efficient:</strong> Lowest CAC at $1,055 but limited scalability due to search volume constraints. Excellent for harvesting high-intent demand.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">2</span>
                <div>
                    <strong>FB Ads - Balanced Performance:</strong> Mid-range CAC at $1,876 with strong scaling potential. Best opportunity for increased budget allocation given current underinvestment.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #E74C3C;">3</span>
                <div>
                    <strong>YouTube Ads - Needs Optimization:</strong> Highest CAC at $2,660 reflects awareness stage traffic. Email capture pivot could reduce effective CAC through extended nurture.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #3498DB;">üìà</span>
                <div>
                    <strong>CAC Trend Improving:</strong> Blended CAC decreased 21% from $1,650 (Q1 2024) to $1,300 (Q2 2025), indicating operational efficiency gains across channels.
                </div>
            </li>
        </ul>

        <h2>CAC Evolution - Monthly Trends</h2>
        <div class="chart-container">
            <div id="cac-monthly-trends" class="highcharts-figure"></div>
        </div>
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #27AE60;">üìâ</span>
                <div>
                    <strong>FB Ads Improving:</strong> CAC dropped 30% from $1,033 (Jan 2024) to $725 (Apr 2025), showing improving targeting efficiency.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #3498DB;">üìä</span>
                <div>
                    <strong>Google Stability:</strong> Maintains $597-$1,375 CAC range, most predictable channel for planning.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">‚ö†Ô∏è</span>
                <div>
                    <strong>YouTube Volatility:</strong> CAC swings from $1,290 to $4,731 reflect varying content performance and audience quality.
                </div>
            </li>
        </div>

        <h2>Business Implications - Channel Strategy</h2>
        
        <div class="recommendation-card">
            <h4>üéØ YouTube: The Awareness Engine</h4>
            <p><strong>Strategic Role:</strong> Drive awareness and email capture, not direct conversions. Current 5.8% email capture rate can be doubled with proper lead magnets and landing pages.</p>
            <p><strong>True Performance:</strong> 2.4x ROAS including email attribution. Focus metrics: email capture rate, nurture conversion, and Google/Organic lift correlation.</p>
        </div>

        <div class="recommendation-card">
            <h4>üöÄ FB Ads: The Conversion Engine</h4>
            <p><strong>Strategic Role:</strong> Convert aware prospects into customers through direct response and retargeting. True 2.86x ROAS with no attribution bias.</p>
            <p><strong>Scaling Opportunity:</strong> Underinvested at 26% of controllable spend. Expand retargeting of YouTube email audiences and scale proven creative.</p>
        </div>

        <div class="recommendation-card">
            <h4>üìß Cross-Channel Email Strategy</h4>
            <p><strong>The Connecting Thread:</strong> YouTube captures emails ‚Üí Email nurture builds intent ‚Üí FB retargeting converts ‚Üí Google harvests branded search.</p>
            <p><strong>Revenue Impact:</strong> 60-day nurture windows show 45% higher conversion rates. Each 1% improvement in YouTube email capture = $800K annual revenue.</p>
        </div>

        <h2>Strategic Implementation Plan</h2>

        <ul class="insights-list">
            <li>
                <span class="insight-icon" style="background: #F39C12;">üìß</span>
                <div>
                    <strong>Week 1-2: Launch YouTube Email Capture Tests</strong><br>
                    Create lead magnet landing pages, educational video content, and sleep assessment tools. Target 10%+ email capture rate (vs 5.8% current).
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #3498DB;">üìò</span>
                <div>
                    <strong>Week 2-3: Scale FB Direct Response</strong><br>
                    Increase FB budget 20-30% focusing on retargeting YouTube visitors and email subscribers. Build lookalike audiences from email list.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">üìä</span>
                <div>
                    <strong>Month 1-2: Implement Attribution Tracking</strong><br>
                    Measure YouTube ‚Üí Google correlation, email ‚Üí sale attribution, and cross-channel customer journeys to optimize total business ROAS.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #9B59B6;">üîÑ</span>
                <div>
                    <strong>Month 2-3: Full Strategy Integration</strong><br>
                    YouTube awareness campaigns ‚Üí Email capture ‚Üí 60-day nurture ‚Üí FB retargeting ‚Üí Google branded search. Optimize each stage for total funnel performance.
                </div>
            </li>
        </ul>

        <h2>Seasonality Analysis - Revenue & Conversion Patterns</h2>
        <div class="chart-container">
            <div id="seasonality-heatmap" class="highcharts-figure"></div>
        </div>
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #E74C3C;">üéÑ</span>
                <div>
                    <strong>Q4 Holiday Surge:</strong> November-December revenue 30-40% above average ($7.3-7.4M vs $5M baseline).
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">üå∏</span>
                <div>
                    <strong>Spring Peak:</strong> May consistently shows strong performance ($7.7M in 2024, $8.5M in 2025).
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #95A5A6;">‚ùÑÔ∏è</span>
                <div>
                    <strong>Q1 Slowdown:</strong> January-February weakest months, requiring 15-20% budget reduction.
                </div>
            </li>
        </div>

        <h3>Conversion Rate Seasonality by Channel</h3>
        <div class="chart-container">
            <div id="conversion-seasonality" class="highcharts-figure"></div>
        </div>
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #3498DB;">üìä</span>
                <div>
                    <strong>Google Consistency:</strong> Maintains 0.6-0.8% conversion year-round, proving high-intent traffic quality.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">üéØ</span>
                <div>
                    <strong>Q4 Lift:</strong> All channels see 20-30% conversion rate improvement during holiday season.
                </div>
            </li>
        </div>

        <div class="data-needs">
            <h3>Priority Data Needs</h3>
            <ul>
                <li><strong>Google Ads Breakdown: </strong> Understand spend allocation across Display, Branded Search, and Non-Branded Search campaigns to optimize channel mix</li>
                <li><strong>Lift Studies: </strong> Implement incrementality testing to measure true channel contribution beyond last-click attribution</li>
                <li><strong>Marketing Mix Modeling (MMM): </strong> Deploy statistical models to understand cross-channel interactions and optimal budget allocation</li>
                <li><strong>Post-Purchase Surveys: </strong> Collect first-party data on customer journey and channel influence to validate attribution models</li>
                <li><strong>Multi-touch Attribution: </strong> Quantify YouTube's contribution to Google conversions and cross-channel assist rates</li>
                <li><strong>Customer Lifetime Value: </strong> Optimize CAC thresholds by channel quality and customer cohort performance</li>
            </ul>
        </div>

        <div class="chart-container">
            <div id="forecast-chart" class="highcharts-figure"></div>
        </div>
    </div>

    <script>
        // Check if Highcharts loaded
        console.log('Highcharts loaded:', typeof Highcharts !== 'undefined');
        
        // Color palette
        const colors = {
            primary: '#3498DB',
            secondary: '#E74C3C',
            success: '#27AE60',
            warning: '#F39C12',
            muted: '#95A5A6',
            dark: '#2C3E50'
        };

        // Common chart options
        const commonOptions = {
            chart: {
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            }
        };

        // Revenue Trends Chart
        Highcharts.chart('revenue-trends-chart', {
            chart: {
                type: 'line',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Monthly Revenue Trends by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan-24', 'Feb-24', 'Mar-24', 'Apr-24', 'May-24', 'Jun-24', 
                           'Jul-24', 'Aug-24', 'Sep-24', 'Oct-24', 'Nov-24', 'Dec-24',
                           'Jan-25', 'Feb-25', 'Mar-25', 'Apr-25', 'May-25', 'Jun-25'],
                labels: { rotation: -45 }
            },
            yAxis: {
                title: { text: 'Revenue ($M)' },
                labels: {
                    formatter: function() {
                        return '$' + this.value.toFixed(1) + 'M';
                    }
                }
            },
            tooltip: {
                shared: true,
                valuePrefix: '$',
                valueSuffix: 'M',
                valueDecimals: 2
            },
            series: [{
                name: 'Google Ads',
                data: [1.28, 1.31, 1.97, 2.17, 4.42, 3.37, 3.16, 2.53, 2.35, 1.83, 3.30, 3.41, 2.25, 2.38, 1.87, 2.23, 3.93, 3.10],
                color: colors.primary
            }, {
                name: 'YouTube Ads',
                data: [0.003, 0.03, 0.01, 0.04, 0.09, 0.06, 0.09, 0.38, 0.11, 0.07, 0.15, 0.11, 0.08, 0.07, 0.24, 0.56, 1.74, 0.67],
                color: colors.warning
            }, {
                name: 'FB Ads',
                data: [0.08, 0.14, 0.25, 0.25, 0.57, 0.30, 0.20, 0.23, 0.27, 0.19, 0.64, 0.47, 0.27, 0.26, 0.45, 0.31, 0.90, 0.70],
                color: colors.secondary
            }, {
                name: 'Organic + Direct',
                data: [1.04, 0.99, 1.01, 1.26, 2.66, 1.82, 1.85, 2.20, 1.99, 1.87, 3.32, 3.36, 2.00, 2.02, 1.96, 1.83, 2.95, 2.91],
                color: colors.success,
                dashStyle: 'shortdot'
            }],
            plotOptions: {
                line: {
                    dataLabels: { enabled: false },
                    enableMouseTracking: true,
                    marker: { radius: 3 }
                }
            }
        });

        // Channel Comparison Chart
        Highcharts.chart('channel-comparison-chart', {
            chart: {
                type: 'column',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Channel Performance Comparison',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Google Ads', 'YouTube Ads', 'FB Ads', 'Organic + Direct']
            },
            yAxis: [{
                title: { text: 'ROAS', style: { color: colors.primary } },
                labels: { style: { color: colors.primary } }
            }, {
                title: { text: 'Conversion Rate (%)', style: { color: colors.success } },
                labels: { 
                    style: { color: colors.success },
                    formatter: function() {
                        return this.value + '%';
                    }
                },
                opposite: true
            }],
            tooltip: {
                shared: true
            },
            series: [{
                name: 'ROAS',
                data: [4.57, 2.13, 2.86, null],
                color: colors.primary,
                yAxis: 0,
                tooltip: { valueDecimals: 2, valuePrefix: '', valueSuffix: 'x' }
            }, {
                name: 'Conversion Rate',
                type: 'line',
                data: [0.66, 0.02, 0.08, 0.16],
                color: colors.success,
                yAxis: 1,
                marker: { radius: 5 },
                tooltip: { valueDecimals: 3, valueSuffix: '%' }
            }]
        });

        // Funnel Analysis Chart
        console.log('Creating funnel chart...');
        try {
        Highcharts.chart('funnel-analysis-chart', {
            chart: {
                type: 'funnel',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Conversion Funnel by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            plotOptions: {
                series: {
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b> ({point.y:,.0f})',
                        softConnector: true
                    },
                    center: ['50%', '50%'],
                    neckWidth: '30%',
                    neckHeight: '25%',
                    width: '80%'
                }
            },
            series: [{
                name: 'Conversion Funnel',
                data: [
                    ['Total Visitors', 12874000],
                    ['Email Captures', 453289],
                    ['Add to Cart', 85432],
                    ['Orders Placed', 10893]
                ]
            }]
        });
        } catch (e) {
            console.error('Funnel chart error:', e);
        }

        // CAC Analysis Chart
        console.log('Creating CAC chart...');
        try {
        Highcharts.chart('cac-analysis-chart', {
            chart: {
                type: 'column',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Customer Acquisition Cost by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Google Ads', 'FB Ads', 'YouTube Ads']
            },
            yAxis: {
                title: { text: 'CAC ($)' },
                labels: {
                    formatter: function() {
                        return '$' + this.value;
                    }
                }
            },
            tooltip: {
                valuePrefix: '$',
                valueSuffix: '',
                valueDecimals: 0
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true,
                        format: '${point.y:,.0f}',
                        style: { fontWeight: 'bold' }
                    }
                }
            },
            series: [{
                name: 'CAC',
                data: [
                    { y: 1055, color: '#27AE60' },  // Google Ads - Green (best)
                    { y: 1876, color: '#F39C12' },  // FB Ads - Orange (medium)
                    { y: 2660, color: '#E74C3C' }   // YouTube Ads - Red (highest)
                ],
                showInLegend: false
            }]
        });
        } catch (e) {
            console.error('CAC chart error:', e);
        }

        // Forecast Chart
        Highcharts.chart('forecast-chart', {
            chart: {
                type: 'area',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: '6-Month Revenue Forecast',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jul-25', 'Aug-25', 'Sep-25', 'Oct-25', 'Nov-25', 'Dec-25'],
                plotBands: [{
                    from: -0.5,
                    to: 5.5,
                    color: 'rgba(52, 152, 219, 0.05)',
                    label: {
                        text: 'Forecast Period',
                        style: { color: colors.muted }
                    }
                }]
            },
            yAxis: {
                title: { text: 'Revenue ($M)' },
                labels: {
                    formatter: function() {
                        return '$' + this.value.toFixed(1) + 'M';
                    }
                }
            },
            tooltip: {
                shared: true,
                valuePrefix: '$',
                valueSuffix: 'M',
                valueDecimals: 2
            },
            series: [{
                name: 'Forecasted Revenue',
                data: [8.2, 8.5, 8.1, 8.8, 9.4, 9.7],
                color: colors.primary,
                fillColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, Highcharts.color(colors.primary).setOpacity(0.3).get('rgba')],
                        [1, Highcharts.color(colors.primary).setOpacity(0).get('rgba')]
                    ]
                },
                marker: { radius: 4 }
            }, {
                name: 'Upper Confidence',
                data: [9.1, 9.4, 9.0, 9.7, 10.3, 10.6],
                type: 'line',
                color: colors.muted,
                dashStyle: 'shortdash',
                marker: { enabled: false }
            }, {
                name: 'Lower Confidence',
                data: [7.3, 7.6, 7.2, 7.9, 8.5, 8.8],
                type: 'line',
                color: colors.muted,
                dashStyle: 'shortdash',
                marker: { enabled: false }
            }]
        });

        // CAC Monthly Trends Chart
        Highcharts.chart('cac-monthly-trends', {
            chart: { 
                type: 'line',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: { enabled: false },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: { 
                text: 'Customer Acquisition Cost Trends by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan-24', 'Feb-24', 'Mar-24', 'Apr-24', 'May-24', 'Jun-24', 
                           'Jul-24', 'Aug-24', 'Sep-24', 'Oct-24', 'Nov-24', 'Dec-24',
                           'Jan-25', 'Feb-25', 'Mar-25', 'Apr-25', 'May-25', 'Jun-25'],
                labels: { rotation: -45 }
            },
            yAxis: {
                title: { text: 'CAC ($)' },
                labels: {
                    formatter: function() {
                        return '$' + this.value.toLocaleString();
                    }
                }
            },
            tooltip: {
                valuePrefix: '$',
                valueDecimals: 0,
                shared: true
            },
            plotOptions: {
                line: {
                    dataLabels: { enabled: false },
                    marker: { radius: 4 }
                }
            },
            series: [{
                name: 'Google Ads',
                data: [597, 557, 705, 645, 865, 770, 748, 854, 792, 920, 797, 851, 872, 732, 886, 823, 1001, 957],
                color: colors.primary
            }, {
                name: 'YouTube Ads',
                data: [1290, 1536, 1880, 2038, 3313, 1851, 1700, 2164, 2421, 2073, 2738, 2520, 2696, 3124, 2501, 2170, 2593, 2491],
                color: colors.warning
            }, {
                name: 'FB Ads',
                data: [1033, 781, 1106, 1018, 1379, 1196, 1320, 1362, 1169, 1258, 1469, 1284, 1143, 1521, 1409, 1267, 1595, 1725],
                color: colors.secondary
            }]
        });

        // YouTube-Google Correlation Chart
        Highcharts.chart('youtube-google-correlation', {
            chart: { 
                zoomType: 'xy',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: { enabled: false },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: { 
                text: 'YouTube Investment Impact on Google Performance',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan-24', 'Feb-24', 'Mar-24', 'Apr-24', 'May-24', 'Jun-24', 
                           'Jul-24', 'Aug-24', 'Sep-24', 'Oct-24', 'Nov-24', 'Dec-24',
                           'Jan-25', 'Feb-25', 'Mar-25', 'Apr-25', 'May-25', 'Jun-25'],
                labels: { rotation: -45 }
            },
            yAxis: [{
                title: { 
                    text: 'YouTube Spend ($K)',
                    style: { color: colors.warning }
                },
                labels: {
                    formatter: function() {
                        return '$' + this.value + 'K';
                    },
                    style: { color: colors.warning }
                }
            }, {
                title: { 
                    text: 'Google Orders',
                    style: { color: colors.primary }
                },
                opposite: true,
                labels: { style: { color: colors.primary } }
            }],
            tooltip: { shared: true },
            plotOptions: {
                column: { borderWidth: 0 }
            },
            series: [{
                name: 'YouTube Spend',
                type: 'column',
                yAxis: 0,
                data: [1.3, 15.4, 7.5, 24.5, 56.3, 29.6, 42.5, 181.7, 63.0, 37.3, 93.1, 70.6, 48.5, 46.9, 152.5, 271.2, 811.5, 316.5],
                color: 'rgba(243, 156, 18, 0.7)',
                tooltip: { valuePrefix: '$', valueSuffix: 'K' }
            }, {
                name: 'Google Orders',
                type: 'line',
                yAxis: 1,
                data: [467, 475, 676, 719, 1125, 927, 888, 668, 606, 472, 865, 892, 602, 665, 501, 620, 860, 689],
                color: colors.primary,
                marker: { radius: 5 },
                lineWidth: 3
            }]
        });

        // Seasonality Heatmap
        Highcharts.chart('seasonality-heatmap', {
            chart: { 
                type: 'heatmap',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: { enabled: false },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: { 
                text: 'Revenue Seasonality Pattern',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yAxis: {
                categories: ['2024', '2025'],
                title: null
            },
            colorAxis: {
                min: 0,
                max: 10,
                stops: [
                    [0, '#ffffff'],
                    [0.3, '#fef0d9'],
                    [0.5, '#fdcc8a'],
                    [0.7, '#fc8d59'],
                    [1, '#d7301f']
                ],
                labels: {
                    formatter: function() {
                        return '$' + this.value + 'M';
                    }
                }
            },
            legend: {
                align: 'right',
                layout: 'vertical',
                margin: 0,
                verticalAlign: 'middle',
                y: 25,
                symbolHeight: 200
            },
            tooltip: {
                formatter: function() {
                    return this.series.xAxis.categories[this.point.x] + ' ' +
                           this.series.yAxis.categories[this.point.y] + ': <b>$' +
                           this.point.value.toFixed(2) + 'M</b> revenue';
                }
            },
            series: [{
                name: 'Revenue',
                borderWidth: 1,
                borderColor: '#e0e0e0',
                data: [
                    // 2024
                    [0, 0, 2.4], [1, 0, 2.5], [2, 0, 3.2], [3, 0, 3.9], [4, 0, 7.7], [5, 0, 5.6],
                    [6, 0, 5.3], [7, 0, 5.3], [8, 0, 4.7], [9, 0, 3.9], [10, 0, 7.3], [11, 0, 7.4],
                    // 2025 (partial)
                    [0, 1, 4.4], [1, 1, 4.9], [2, 1, 4.3], [3, 1, 4.6], [4, 1, 8.5], [5, 1, 7.4]
                ],
                dataLabels: {
                    enabled: true,
                    format: '{point.value:.1f}M',
                    style: { color: '#000000' }
                }
            }]
        });

        // Conversion Rate Seasonality
        Highcharts.chart('conversion-seasonality', {
            chart: { 
                type: 'area',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: { enabled: false },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: { 
                text: 'Conversion Rate Seasonality by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yAxis: {
                title: { text: 'Conversion Rate (%)' },
                labels: {
                    formatter: function() {
                        return this.value + '%';
                    }
                }
            },
            tooltip: {
                valueSuffix: '%',
                valueDecimals: 3,
                shared: true
            },
            plotOptions: {
                area: {
                    stacking: null,
                    lineColor: '#666666',
                    lineWidth: 1,
                    fillOpacity: 0.3,
                    marker: { radius: 2 }
                }
            },
            series: [{
                name: 'Google Ads',
                data: [0.46, 0.47, 0.51, 0.52, 0.68, 0.71, 0.64, 0.68, 0.61, 0.58, 0.74, 0.81],
                color: colors.primary
            }, {
                name: 'FB Ads',
                data: [0.03, 0.04, 0.05, 0.05, 0.06, 0.10, 0.07, 0.03, 0.07, 0.06, 0.12, 0.13],
                color: colors.secondary
            }, {
                name: 'YouTube Ads',
                data: [0.003, 0.028, 0.009, 0.017, 0.010, 0.015, 0.012, 0.021, 0.014, 0.013, 0.006, 0.007],
                color: colors.warning
            }, {
                name: 'Organic',
                data: [0.15, 0.22, 0.20, 0.17, 0.18, 0.17, 0.12, 0.13, 0.12, 0.14, 0.26, 0.26],
                color: colors.success
            }]
        });
    </script>
</body>
</html>