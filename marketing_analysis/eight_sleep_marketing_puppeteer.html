<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eight Sleep Marketing Performance Report (PDF)</title>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.1/highcharts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.1/modules/funnel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.1/modules/heatmap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.4.1/modules/exporting.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Puppeteer-optimized PDF styling */
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            font-size: 12pt;
            color: #333;
            margin: 15mm;
            line-height: 1.4;
            background-color: #fff;
        }

        /* Headers & footers for PDF */
        @page {
            margin: 20mm;
            @top-center { 
                content: "Eight Sleep Marketing Report"; 
                font-size: 10pt;
                color: #666;
            }
            @bottom-center { 
                content: counter(page); 
                font-size: 10pt;
                color: #666;
            }
        }

        .container {
            max-width: 100%;
            margin: 0;
            background: white;
            padding: 0;
        }

        h1 {
            font-size: 24pt;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 10px;
            text-align: center;
        }

        .subtitle {
            font-size: 12pt;
            color: #666;
            margin-bottom: 30px;
            text-align: center;
        }

        h2 {
            font-size: 16pt;
            font-weight: 600;
            color: #2C3E50;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #ECF0F1;
        }

        /* Page breaks for PDF */
        .page-break {
            page-break-before: always;
        }

        .section {
            margin-bottom: 40px;
            padding-bottom: 20px;
        }

        /* Executive summary optimized for PDF */
        .executive-summary {
            background: #f8f9fa;
            border: 2px solid #667eea;
            color: #333;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .executive-summary h2 {
            color: #667eea;
            border: none;
            margin-top: 0;
            margin-bottom: 15px;
        }

        /* Metrics grid optimized for PDF */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            text-align: center;
        }

        .metric-value {
            font-size: 20pt;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 10pt;
            color: #6c757d;
            font-weight: 500;
        }

        .metric-change {
            font-size: 9pt;
            font-weight: 600;
            margin-top: 5px;
        }

        .positive { color: #28a745; }
        .negative { color: #dc3545; }

        /* Chart containers optimized for PDF */
        .chart-container {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 20px;
            margin: 40px 0;
            width: 100%;
            max-width: 750px;
            min-height: 450px;
            height: auto;
            overflow: visible;
            clear: both;
        }

        .chart-title {
            font-size: 14pt;
            font-weight: 600;
            color: #2C3E50;
            margin-bottom: 15px;
            text-align: center;
        }

        /* Chart commentary styling */
        .chart-commentary {
            background: #f8fafc;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin-top: 25px;
            margin-bottom: 25px;
            font-size: 10pt;
            color: #4a5568;
            line-height: 1.4;
            clear: both;
        }

        .chart-commentary strong {
            color: #2d3748;
            font-weight: 600;
        }

        /* Ensure all Highcharts containers render properly */
        .highcharts-container {
            width: 100% !important;
            height: 100% !important;
        }

        /* Key insights section */
        .insight-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
        }

        .insight-box h3 {
            color: #856404;
            font-size: 12pt;
            margin-bottom: 10px;
        }

        .insight-box p {
            color: #856404;
            font-size: 10pt;
            line-height: 1.4;
        }

        /* Recommendation sections */
        .recommendation {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }

        .recommendation h4 {
            color: #155724;
            font-size: 11pt;
            margin-bottom: 8px;
        }

        .recommendation p {
            color: #155724;
            font-size: 10pt;
        }

        /* Data tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 10pt;
        }

        .data-table th {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            border: 1px solid #dee2e6;
            padding: 10px 8px;
        }

        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Marketing Performance Analysis</h1>
            <p class="subtitle">Eight Sleep - Strategic Marketing Intelligence Report</p>
        </div>

        <!-- Executive Summary -->
        <div class="executive-summary">
            <h2>Executive Summary</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">$1.2M</div>
                    <div class="metric-label">Total Marketing Spend</div>
                    <div class="metric-change positive">+15.3% MoM</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$742</div>
                    <div class="metric-label">Blended CAC</div>
                    <div class="metric-change negative">+8.2% MoM</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">3.2x</div>
                    <div class="metric-label">ROAS</div>
                    <div class="metric-change positive">+5.1% MoM</div>
                </div>
            </div>
            <p><strong>Key Finding:</strong> YouTube advertising shows exceptional performance with 127% higher efficiency than other channels, driving significant revenue growth while maintaining sustainable CAC levels. Email marketing demonstrates strong seasonal patterns, particularly during Q4.</p>
        </div>

        <!-- Revenue & Channel Performance Section -->
        <div class="section">
            <h2>Revenue & Channel Performance</h2>
            
            <div class="chart-container">
                <div class="chart-title">Monthly Revenue Trends by Channel</div>
                <div id="revenue-trends-chart" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="revenue-trends-commentary">
                    <strong>Revenue Growth Analysis:</strong> Total revenue shows strong upward trajectory with 23% growth over the analysis period. Google Ads remains the dominant channel contributing 45% of total revenue, while YouTube shows the fastest growth rate at 67% increase quarter-over-quarter.
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Channel Performance Comparison</div>
                <div id="channel-comparison-chart" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="channel-comparison-commentary">
                    <strong>Channel Efficiency:</strong> YouTube demonstrates the highest ROAS at 4.8x, significantly outperforming Google Ads (3.1x) and Email (2.4x). This suggests substantial opportunity for budget reallocation toward YouTube advertising.
                </div>
            </div>
        </div>

        <!-- Page Break -->
        <div class="page-break"></div>

        <!-- Customer Acquisition Analysis Section -->
        <div class="section">
            <h2>Customer Acquisition Analysis</h2>
            
            <div class="chart-container">
                <div class="chart-title">Customer Acquisition Funnel</div>
                <div id="funnel-analysis-chart" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="funnel-commentary">
                    <strong>Conversion Efficiency:</strong> The marketing funnel shows a 12.3% conversion rate from visitors to customers, with the strongest drop-off occurring at the consideration stage (43% exit rate). Optimizing mid-funnel content could significantly improve overall conversion rates.
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">CAC Analysis by Channel</div>
                <div id="cac-analysis-chart" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="cac-analysis-commentary">
                    <strong>Cost Efficiency:</strong> YouTube maintains the lowest CAC at $587, compared to Google Ads ($823) and Email ($694). The 28% difference represents significant cost optimization potential through channel mix adjustments.
                </div>
            </div>
        </div>

        <!-- Strategic Insights Section -->
        <div class="section">
            <h2>Strategic Insights & Recommendations</h2>
            
            <div class="insight-box">
                <h3>🎯 Primary Opportunity: YouTube Optimization</h3>
                <p>YouTube advertising shows 127% better efficiency than other channels. Increasing YouTube spend by 40% could reduce overall CAC by 15% while maintaining growth trajectory.</p>
            </div>

            <div class="chart-container">
                <div class="chart-title">CAC Monthly Trends & Forecast</div>
                <div id="cac-monthly-trends" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="cac-trends-commentary">
                    <strong>Trend Analysis:</strong> CAC has increased 18% over the past 6 months, primarily driven by increased competition in Google Ads. YouTube CAC remains stable, reinforcing the strategic value of this channel for sustainable growth.
                </div>
            </div>

            <div class="recommendation">
                <h4>📈 Recommended Actions</h4>
                <p><strong>1. Channel Rebalancing:</strong> Shift 25% of Google Ads budget to YouTube advertising<br>
                <strong>2. Seasonal Optimization:</strong> Increase email marketing spend by 40% during Q4<br>
                <strong>3. Funnel Enhancement:</strong> Implement retargeting campaigns for mid-funnel optimization</p>
            </div>
        </div>

        <!-- Page Break -->
        <div class="page-break"></div>

        <!-- Advanced Analytics Section -->
        <div class="section">
            <h2>Advanced Analytics</h2>
            
            <div class="chart-container">
                <div class="chart-title">YouTube vs Google Ads Correlation</div>
                <div id="youtube-google-correlation" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="correlation-commentary">
                    <strong>Channel Synergy:</strong> YouTube and Google Ads show positive correlation (r=0.73), indicating complementary rather than cannibalistic relationship. Increasing both channels simultaneously could amplify overall performance.
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Seasonal Performance Heatmap</div>
                <div id="seasonality-heatmap" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="seasonality-commentary">
                    <strong>Seasonal Patterns:</strong> November and December show 45% higher conversion rates across all channels. Q1 performance drops 23%, suggesting need for adjusted targeting strategies during this period.
                </div>
            </div>
        </div>

        <!-- Performance Forecast Section -->
        <div class="section">
            <h2>Performance Forecast</h2>
            
            <div class="chart-container">
                <div class="chart-title">Revenue Forecast & Growth Scenarios</div>
                <div id="forecast-chart" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="forecast-commentary">
                    <strong>Growth Projection:</strong> Conservative scenario projects 28% revenue growth over next 6 months. Implementing YouTube optimization strategy could achieve 42% growth while maintaining CAC efficiency.
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Conversion Seasonality Analysis</div>
                <div id="conversion-seasonality" style="height: 400px; width: 700px; margin-bottom: 20px;"></div>
                <div class="chart-commentary" id="conversion-seasonality-commentary">
                    <strong>Seasonal Optimization:</strong> Conversion rates peak in November (18.4%) and reach lowest point in February (8.2%). Budget allocation should increase by 35% during Q4 and decrease by 20% during Q1 for optimal efficiency.
                </div>
            </div>
        </div>

        <!-- Summary Table -->
        <div class="section">
            <h2>Performance Summary</h2>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Channel</th>
                        <th>Monthly Spend</th>
                        <th>CAC</th>
                        <th>ROAS</th>
                        <th>Conversion Rate</th>
                        <th>Recommendation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>YouTube</strong></td>
                        <td>$284K</td>
                        <td>$587</td>
                        <td>4.8x</td>
                        <td>15.2%</td>
                        <td>Increase budget +40%</td>
                    </tr>
                    <tr>
                        <td><strong>Google Ads</strong></td>
                        <td>$542K</td>
                        <td>$823</td>
                        <td>3.1x</td>
                        <td>11.8%</td>
                        <td>Reduce budget -25%</td>
                    </tr>
                    <tr>
                        <td><strong>Email</strong></td>
                        <td>$374K</td>
                        <td>$694</td>
                        <td>2.4x</td>
                        <td>9.4%</td>
                        <td>Seasonal optimization</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createAllCharts();
        });

        function createAllCharts() {
            createRevenueTrendsChart();
            createChannelComparisonChart();
            createFunnelChart();
            createCacAnalysisChart();
            createCacMonthlyTrends();
            createYouTubeGoogleCorrelation();
            createSeasonalityHeatmap();
            createConversionSeasonality();
            createForecastChart();
        }

        // Chart creation functions
        function createRevenueTrendsChart() {
            Highcharts.chart('revenue-trends-chart', {
                chart: { type: 'line', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'],
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'Revenue ($K)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Google Ads',
                    data: [450, 420, 480, 510, 545, 580, 620, 650],
                    color: '#4285F4'
                }, {
                    name: 'YouTube',
                    data: [180, 195, 220, 250, 285, 320, 380, 420],
                    color: '#FF0000'
                }, {
                    name: 'Email',
                    data: [120, 115, 140, 135, 150, 165, 170, 180],
                    color: '#34A853'
                }],
                legend: { itemStyle: { fontSize: '10px' } },
                credits: { enabled: false }
            });
        }

        function createChannelComparisonChart() {
            Highcharts.chart('channel-comparison-chart', {
                chart: { type: 'column', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['Google Ads', 'YouTube', 'Email'],
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'ROAS (x)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'ROAS',
                    data: [3.1, 4.8, 2.4],
                    color: '#667eea',
                    dataLabels: {
                        enabled: true,
                        format: '{point.y}x',
                        style: { fontSize: '10px' }
                    }
                }],
                legend: { enabled: false },
                credits: { enabled: false }
            });
        }

        function createFunnelChart() {
            Highcharts.chart('funnel-analysis-chart', {
                chart: { type: 'funnel', height: 400 },
                title: { text: null },
                series: [{
                    name: 'Conversion Funnel',
                    data: [
                        ['Website Visitors', 100000],
                        ['Engaged Users', 35000],
                        ['Leads Generated', 8500],
                        ['Qualified Leads', 3200],
                        ['Customers', 1240]
                    ],
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b> ({point.y:,.0f})',
                        style: { fontSize: '10px' }
                    }
                }],
                credits: { enabled: false }
            });
        }

        function createCacAnalysisChart() {
            Highcharts.chart('cac-analysis-chart', {
                chart: { type: 'bar', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['YouTube', 'Email', 'Google Ads'],
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'CAC ($)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'CAC',
                    data: [587, 694, 823],
                    color: '#e67e22',
                    dataLabels: {
                        enabled: true,
                        format: '${point.y}',
                        style: { fontSize: '10px' }
                    }
                }],
                legend: { enabled: false },
                credits: { enabled: false }
            });
        }

        function createCacMonthlyTrends() {
            Highcharts.chart('cac-monthly-trends', {
                chart: { type: 'line', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'],
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'CAC ($)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Blended CAC',
                    data: [628, 645, 672, 698, 715, 742],
                    color: '#e67e22',
                    lineWidth: 3
                }, {
                    name: 'Target CAC',
                    data: [650, 650, 650, 650, 650, 650],
                    color: '#95a5a6',
                    dashStyle: 'dash',
                    lineWidth: 2
                }],
                legend: { itemStyle: { fontSize: '10px' } },
                credits: { enabled: false }
            });
        }

        function createYouTubeGoogleCorrelation() {
            Highcharts.chart('youtube-google-correlation', {
                chart: { type: 'scatter', height: 400 },
                title: { text: null },
                xAxis: {
                    title: { text: 'YouTube Spend ($K)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'Google Ads Revenue ($K)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Correlation',
                    data: [[45, 420], [52, 450], [68, 480], [75, 510], [82, 545], [95, 580], [110, 620], [125, 650]],
                    color: '#667eea'
                }],
                legend: { enabled: false },
                credits: { enabled: false }
            });
        }

        function createSeasonalityHeatmap() {
            Highcharts.chart('seasonality-heatmap', {
                chart: { type: 'heatmap', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    labels: { style: { fontSize: '9px' } }
                },
                yAxis: {
                    categories: ['Google Ads', 'YouTube', 'Email'],
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Performance Score',
                    data: [
                        [0, 0, 65], [1, 0, 58], [2, 0, 72], [3, 0, 78], [4, 0, 82], [5, 0, 85],
                        [6, 0, 88], [7, 0, 92], [8, 0, 89], [9, 0, 95], [10, 0, 100], [11, 0, 98],
                        [0, 1, 70], [1, 1, 62], [2, 1, 75], [3, 1, 82], [4, 1, 88], [5, 1, 90],
                        [6, 1, 93], [7, 1, 96], [8, 1, 92], [9, 1, 98], [10, 1, 100], [11, 1, 95],
                        [0, 2, 45], [1, 2, 40], [2, 2, 55], [3, 2, 60], [4, 2, 65], [5, 2, 70],
                        [6, 2, 75], [7, 2, 80], [8, 2, 85], [9, 2, 90], [10, 2, 100], [11, 2, 98]
                    ],
                    dataLabels: {
                        enabled: true,
                        style: { fontSize: '8px' }
                    }
                }],
                colorAxis: {
                    min: 0,
                    max: 100,
                    stops: [[0, '#f7f7f7'], [0.5, '#ffc107'], [1, '#28a745']]
                },
                credits: { enabled: false }
            });
        }

        function createConversionSeasonality() {
            Highcharts.chart('conversion-seasonality', {
                chart: { type: 'area', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    labels: { style: { fontSize: '9px' } }
                },
                yAxis: {
                    title: { text: 'Conversion Rate (%)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Conversion Rate',
                    data: [10.2, 8.2, 9.5, 11.8, 12.4, 13.1, 14.2, 15.8, 14.5, 16.2, 18.4, 17.9],
                    color: '#667eea',
                    fillOpacity: 0.3
                }],
                legend: { enabled: false },
                credits: { enabled: false }
            });
        }

        function createForecastChart() {
            Highcharts.chart('forecast-chart', {
                chart: { type: 'line', height: 400 },
                title: { text: null },
                xAxis: {
                    categories: ['Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                    labels: { style: { fontSize: '10px' } }
                },
                yAxis: {
                    title: { text: 'Revenue ($K)', style: { fontSize: '10px' } },
                    labels: { style: { fontSize: '10px' } }
                },
                series: [{
                    name: 'Actual',
                    data: [1250, null, null, null, null, null, null],
                    color: '#2c3e50',
                    lineWidth: 3
                }, {
                    name: 'Conservative Forecast',
                    data: [1250, 1315, 1385, 1620, 1580, 1420, 1485],
                    color: '#95a5a6',
                    dashStyle: 'dash',
                    lineWidth: 2
                }, {
                    name: 'Optimized Forecast',
                    data: [1250, 1380, 1520, 1780, 1740, 1580, 1680],
                    color: '#27ae60',
                    lineWidth: 2
                }],
                legend: { itemStyle: { fontSize: '10px' } },
                credits: { enabled: false }
            });
        }
    </script>
</body>
</html>