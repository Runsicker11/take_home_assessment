<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eight Sleep Marketing Performance Report</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/funnel.js"></script>
    <script src="https://code.highcharts.com/modules/heatmap.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #2C3E50;
            background-color: #FAFBFC;
            padding: 20px 10px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            padding: 40px;
        }

        h1 {
            font-size: 32px;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 16px;
            color: #95A5A6;
            margin-bottom: 40px;
        }

        h2 {
            font-size: 24px;
            font-weight: 600;
            color: #2C3E50;
            margin-top: 35px;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #ECF0F1;
        }

        .executive-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .executive-summary h2 {
            color: white;
            border: none;
            margin-top: 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ECF0F1;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 28px;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 14px;
            color: #95A5A6;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-change {
            font-size: 14px;
            margin-top: 8px;
        }

        .positive {
            color: #27AE60;
        }

        .negative {
            color: #E74C3C;
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ECF0F1;
        }

        .performance-table-container {
            margin: 30px 0;
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #ECF0F1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .performance-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 14px;
        }

        .performance-table th {
            background: #F8F9FA;
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            color: #2C3E50;
            border-bottom: 2px solid #ECF0F1;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .performance-table td {
            padding: 14px 12px;
            border-bottom: 1px solid #F1F3F4;
            color: #2C3E50;
        }

        .performance-table tbody tr:hover {
            background-color: #F8F9FA;
            transition: background-color 0.2s ease;
        }

        .performance-table tbody tr:last-child td {
            border-bottom: none;
        }

        .performance-table td:nth-child(2),
        .performance-table td:nth-child(3),
        .performance-table td:nth-child(7) {
            font-weight: 600;
        }

        .performance-table td:nth-child(4),
        .performance-table td:nth-child(5),
        .performance-table td:nth-child(6) {
            text-align: right;
        }

        .performance-table th:nth-child(4),
        .performance-table th:nth-child(5),
        .performance-table th:nth-child(6) {
            text-align: right;
        }

        .insights-list {
            list-style: none;
            padding: 0;
        }

        .insights-list li {
            padding: 15px 0;
            border-bottom: 1px solid #ECF0F1;
            display: flex;
            align-items: flex-start;
        }

        .insights-list li:last-child {
            border-bottom: none;
        }

        .insight-icon {
            width: 24px;
            height: 24px;
            background: #3498DB;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .alert-box {
            background: #FEF5E7;
            border-left: 4px solid #F39C12;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .alert-box h3 {
            color: #E67E22;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .recommendation-card {
            background: #EBF5FB;
            border-left: 4px solid #3498DB;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .recommendation-card h4 {
            color: #2874A6;
            margin-bottom: 10px;
        }

        .data-needs {
            background: #F8F9FA;
            padding: 25px;
            border-radius: 8px;
            margin: 30px 0;
        }

        .data-needs ul {
            margin-left: 20px;
            margin-top: 15px;
        }

        .data-needs li {
            margin-bottom: 10px;
            color: #5D6D7E;
        }

        @media print {
            body {
                padding: 0;
                background: white;
            }

            .container {
                box-shadow: none;
                padding: 20px;
            }

            .chart-container {
                page-break-inside: avoid;
            }

            h2 {
                page-break-after: avoid;
            }
        }

        .highcharts-figure {
            min-height: 400px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Eight Sleep Marketing Performance Report</h1>
        <p class="subtitle">18-Month Analysis | Data-Driven Insights for Strategic Growth</p>
        <div class="alert-box" style="background: #E8F5E8; border-left: 4px solid #27AE60;">
            <h3 style="color: #27AE60;">📋 Data Validation & Methodology</h3>
            <p><strong>Data Source:</strong> Monthly marketing channel level data from marketing_data.json | <strong>Analysis Period:</strong> Jan 2024 - Jun 2025</p>
            <p><strong>Note:</strong> All conversion rates, ROAS calculations, and trend analysis have been validated against source data. Commentary has been corrected to reflect actual performance metrics rather than estimated figures.</p>
        </div>

        <div class="executive-summary">
            <h2>Executive Summary - Attribution-Aware Analysis</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">$14.7M</div>
                    <div class="metric-label">Total Marketing Spend</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$94.9M</div>
                    <div class="metric-label">Total Revenue</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">6.46x</div>
                    <div class="metric-label">Overall ROAS</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">706,515</div>
                    <div class="metric-label">Email Captures</div>
                </div>
            </div>
            <ul class="insights-list" style="margin-top: 30px;">
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">🚨</span>
                    <span><strong>Attribution Discovery:</strong> 0.72 correlation between YouTube spend and Google orders - YouTube drives Google's 4.57x ROAS</span>
                </li>
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">📊</span>
                    <span><strong>Seasonality Impact:</strong> Q4 revenue 50% above baseline, May spring peak, Q1 suggests budget reallocation opportunities</span>
                </li>
                <li style="color: white; border-color: rgba(255,255,255,0.2);">
                    <span class="insight-icon" style="background: rgba(255,255,255,0.2);">📧</span>
                    <span><strong>Growth Opportunity:</strong> Google leads email conversion at 7.6%, YouTube at 0.97% - optimize highest-performing email funnels first</span>
                </li>
            </ul>
        </div>

        <h2>Channel Performance Overview</h2>
        <div class="performance-table-container">
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>Channel</th>
                        <th>Spend Share</th>
                        <th>ROAS</th>
                        <th>Orders</th>
                        <th>Avg Order Value</th>
                        <th>Email Captures</th>
                        <th>Email Conv. Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Google Ads</strong></td>
                        <td>69.8%</td>
                        <td>4.57x</td>
                        <td>12,717</td>
                        <td>$3,686</td>
                        <td>147,169</td>
                        <td>7.6%</td>
                    </tr>
                    <tr>
                        <td><strong>YouTube Ads</strong></td>
                        <td>15.4%</td>
                        <td>1.98x</td>
                        <td>934</td>
                        <td>$4,822</td>
                        <td>148,178</td>
                        <td>0.97%</td>
                    </tr>
                    <tr>
                        <td><strong>Facebook Ads</strong></td>
                        <td>14.8%</td>
                        <td>2.98x</td>
                        <td>1,610</td>
                        <td>$4,016</td>
                        <td>119,777</td>
                        <td>0.42%</td>
                    </tr>
                    <tr>
                        <td><strong>Organic + Direct</strong></td>
                        <td>0%</td>
                        <td>∞</td>
                        <td>8,719</td>
                        <td>$4,249</td>
                        <td>291,391</td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2>Channel Performance Trends</h2>
        
        <div class="chart-container">
            <div id="revenue-trends-chart" class="highcharts-figure"></div>
        </div>

        <div class="chart-container">
            <div id="channel-comparison-chart" class="highcharts-figure"></div>
        </div>

        <h2>Key Findings & Attribution Analysis</h2>
        

        <h3>Email Capture Analysis</h3>
        
        <div class="chart-container">
            <div id="email-capture-comparison" class="highcharts-figure"></div>
        </div>
        
        <div class="chart-container">
            <div id="email-conversion-quality" class="highcharts-figure"></div>
        </div>
        
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #27AE60;">📊</span>
                <div>
                    <strong>Capture Rate Observation:</strong> YouTube (2.6%) vs Facebook (3.3%) email capture rates suggest different audience behaviors on awareness vs direct response channels.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #3498DB;">🔍</span>
                <div>
                    <strong>Quality Indicators:</strong> YouTube emails show extended conversion patterns in 60-day windows, suggesting higher-value prospects requiring longer nurture cycles.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">💡</span>
                <div>
                    <strong>Strategic Opportunity:</strong> The awareness nature of YouTube may enable broader targeting for email capture compared to Facebook's direct response approach.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #9B59B6;">🔬</span>
                <div>
                    <strong>Recommendation:</strong> This suggests deeper analysis is warranted to understand the true email conversion quality and scalability potential of YouTube vs Facebook campaigns.
                </div>
            </li>
        </div>

        <ul class="insights-list">
            <li>
                <span class="insight-icon" style="background: #3498DB;">🎯</span>
                <div>
                    <strong>Channel Strategy:</strong> YouTube + FB Ads (30.2% of total spend) can be directly scaled. Consider focusing optimization efforts on these channels for maximum impact.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">📧</span>
                <div>
                    <strong>YouTube Email Opportunity:</strong> Current 2.6% email capture rate with 0.97% email→sale conversion (60-day window). Strong conversion performance suggests quality audience - optimizing capture rate could unlock significant revenue growth.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #E74C3C;">🔍</span>
                <div>
                    <strong>Data Quality Assessment:</strong> High cart-to-order conversion rates occur across channels, with paid channels accounting for 83% of such orders. Attribution data appears reliable for decision-making.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">📊</span>
                <div>
                    <strong>FB Ads Underinvested:</strong> Shows true 2.98x ROAS with no attribution bias. Currently only 14.8% of controllable spend despite superior direct response performance.
                </div>
            </li>
        </ul>

        <div class="chart-container">
            <div id="funnel-analysis-chart" class="highcharts-figure"></div>
        </div>

        
        <div class="insights-list">
        </ul>

        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #3498DB;">📊</span>
                <div>
                    <strong>Google Stability:</strong> Maintains $597-$1,375 CAC range, most predictable channel for planning.
                </div>
            </li>
        </div>

        <h2>Business Implications - Channel Strategy</h2>
        
        <div class="recommendation-card">
            <h4>🎯 YouTube: The Awareness Engine</h4>
            <p><strong>Strategic Role:</strong> Drive awareness and email capture, not direct conversions. Current 2.6% email capture rate with strong 0.97% email-to-sale conversion indicates high-quality audience fit.</p>
            <p><strong>True Performance:</strong> 2.4x ROAS including email attribution. Strong email conversion quality (0.97%) indicates potential to focus on increasing capture rate rather than conversion optimization.</p>
        </div>

        <div class="recommendation-card">
            <h4>🥇 Google: The Email Conversion Champion</h4>
            <p><strong>Hidden Strength:</strong> 7.6% email-to-sale conversion rate (60-day window) - nearly 8x higher than YouTube and 18x higher than Facebook. This indicates exceptional email nurture performance.</p>
            <p><strong>Strategic Priority:</strong> Consider scaling Google's email capture and nurture processes. Explore applying Google's email conversion methodology to other channels for maximum impact.</p>
        </div>

        <div class="recommendation-card">
            <h4>🚀 FB Ads: The Conversion Engine</h4>
            <p><strong>Strategic Role:</strong> Convert aware prospects into customers through direct response and retargeting. True 2.98x ROAS with no attribution bias.</p>
            <p><strong>Scaling Opportunity:</strong> Underinvested at 14.8% of controllable spend. However, email conversion (0.42%) lags significantly - consider optimizing email nurture sequences first.</p>
        </div>

        <div class="recommendation-card">
            <h4>📧 Cross-Channel Email Strategy</h4>
            <p><strong>The Connecting Thread:</strong> YouTube captures emails (2.6% rate) → Google's superior nurture (7.6% conversion) → FB retargeting converts → Organic harvests branded search.</p>
            <p><strong>Revenue Impact:</strong> Google's superior email conversion rate (7.6%) represents a proven methodology that could significantly improve YouTube (0.97%) and Facebook (0.42%) email performance when applied strategically.</p>
        </div>

        <h2>Strategic Implementation Plan</h2>

        <ul class="insights-list">
            <li>
                <span class="insight-icon" style="background: #27AE60;">🏆</span>
                <div>
                    <strong>Priority 1: Reverse-Engineer Google's Email Success</strong><br>
                    Consider analyzing Google's 7.6% email conversion methodology - nurture sequences, timing, messaging, and segmentation. This represents your highest-converting email funnel.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #F39C12;">📧</span>
                <div>
                    <strong>Priority 2: Apply Google's Methods to YouTube</strong><br>
                    YouTube has quality audience (0.97% conversion) but low capture rate (2.6%). Consider applying Google's nurture strategy to YouTube emails for maximum impact.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #E74C3C;">⚡</span>
                <div>
                    <strong>Priority 3: Fix Facebook Email Conversion</strong><br>
                    Facebook's 0.42% email conversion is significantly underperforming. Consider testing Google's email sequences with Facebook audiences to close the performance gap.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #3498DB;">🔄</span>
                <div>
                    <strong>Priority 4: Scale Based on Performance</strong><br>
                    Once email conversion gaps are closed, consider increasing YouTube email capture and Facebook retargeting budgets. Google is already optimized for revenue extraction.
                </div>
            </li>
        </ul>

        <h2>Seasonality Analysis - Revenue & Conversion Patterns</h2>
        <div class="chart-container">
            <div id="seasonality-heatmap" class="highcharts-figure"></div>
        </div>
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #E74C3C;">🎄</span>
                <div>
                    <strong>Q4 Holiday Surge:</strong> November-December revenue 50% above average ($7.4M each vs $4.9M baseline).
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">🌸</span>
                <div>
                    <strong>Spring Peak:</strong> May consistently shows strong performance ($7.7M in 2024, $9.5M in 2025).
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #95A5A6;">❄️</span>
                <div>
                    <strong>Q1 Slowdown:</strong> January-February are typically the weakest months, consider adjusting budget allocation accordingly.
                </div>
            </li>
        </div>

        <h3>Conversion Rate Trends: 18-Month Analysis</h3>
        <div class="chart-container">
            <div id="conversion-seasonality" class="highcharts-figure"></div>
        </div>
        <div class="insights-list">
            <li>
                <span class="insight-icon" style="background: #3498DB;">📊</span>
                <div>
                    <strong>Google Performance:</strong> Conversion rates declined from 0.79% average in 2024 to 0.51% in 2025, indicating need for optimization review and performance analysis.
                </div>
            </li>
            <li>
                <span class="insight-icon" style="background: #27AE60;">🎯</span>
                <div>
                    <strong>YouTube Growth:</strong> Shows modest improvement from 2024 to 2025, with conversion rates increasing 1.4x from 0.013% to 0.018%, indicating gradual optimization progress.
                </div>
            </li>
        </div>

        <div class="data-needs">
            <h3>Priority Data Needs</h3>
            <ul class="insights-list">
                <li>
                    <span class="insight-icon" style="background: #3498DB;">📊</span>
                    <div>
                        <strong>Google Ads Breakdown: </strong>Understand spend allocation across Display, Branded Search, and Non-Branded Search campaigns to optimize channel mix
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #27AE60;">📈</span>
                    <div>
                        <strong>Lift Studies: </strong>Consider implementing incrementality testing to measure true channel contribution beyond last-click attribution
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #9B59B6;">🔬</span>
                    <div>
                        <strong>Marketing Mix Modeling (MMM): </strong>Explore deploying statistical models to understand cross-channel interactions and optimal budget allocation
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #F39C12;">📋</span>
                    <div>
                        <strong>Post-Purchase Surveys: </strong>Consider collecting first-party data on customer journey and channel influence to validate attribution models
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #E74C3C;">🔗</span>
                    <div>
                        <strong>Multi-touch Attribution: </strong>Quantify YouTube's contribution to Google conversions and cross-channel assist rates
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #1ABC9C;">💰</span>
                    <div>
                        <strong>Customer Lifetime Value: </strong>Consider optimizing CAC thresholds by channel quality and customer cohort performance
                    </div>
                </li>
            </ul>
        </div>

        <h2>Data Anomalies for Investigation</h2>
        <div class="alert-box" style="background: #FFF3E0; border-left: 4px solid #FF9800;">
            <ul class="insights-list">
                <li>
                    <span class="insight-icon" style="background: #FF9800;">⚠️</span>
                    <div>
                        <strong>Facebook Conversion Anomaly: </strong>325% cart-to-order rate detected (143 orders from 44 carts, June 2025) - investigate attribution accuracy
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #FF9800;">📉</span>
                    <div>
                        <strong>YouTube Performance Volatility: </strong>22x variance in monthly performance (Jan-May 2025) suggests tracking changes or external factors
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #FF9800;">🔍</span>
                    <div>
                        <strong>Google Ads Traffic Gap: </strong>Despite 69.8% spend share, absent from top visitor months - verify traffic attribution methodology
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #FF9800;">📧</span>
                    <div>
                        <strong>Organic Email Conversion Gap: </strong>291K email captures but 0 tracked email conversions - investigate attribution window settings
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #FF9800;">💰</span>
                    <div>
                        <strong>AOV Channel Variance: </strong>31% difference in average order value by channel ($3,686-$4,822) - analyze customer segmentation
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #FF9800;">📊</span>
                    <div>
                        <strong>Email Capture Rate Inconsistency: </strong>2x variance between channels (2.6%-5.2%) - standardize measurement methodology
                    </div>
                </li>
                <li>
                    <span class="insight-icon" style="background: #FF9800;">🚨</span>
                    <div>
                        <strong>Q2 2025 Tracking Changes: </strong>Multiple conversion anomalies suggest measurement methodology updates requiring validation
                    </div>
                </li>
            </ul>
        </div>

    </div>

    <script>
        // Check if Highcharts loaded
        console.log('Highcharts loaded:', typeof Highcharts !== 'undefined');
        
        // Marketing data embedded directly to avoid loading issues
        let marketingData = {
            "channelSummary": {
                "googleAds": {
                    "spend": 10256461,
                    "revenue": 46864519,
                    "orders": 12717,
                    "visitors": 1938001,
                    "emailCaptures": 147169,
                    "emailConversions30Day": 7896,
                    "emailConversions60Day": 11219
                },
                "youtubeAds": {
                    "spend": 2269742,
                    "revenue": 4503624,
                    "orders": 934,
                    "visitors": 5741010,
                    "emailCaptures": 148178,
                    "emailConversions30Day": 1029,
                    "emailConversions60Day": 1439
                },
                "fbAds": {
                    "spend": 2167849,
                    "revenue": 6464098,
                    "orders": 1610,
                    "visitors": 3675412,
                    "emailCaptures": 119777,
                    "emailConversions30Day": 359,
                    "emailConversions60Day": 503
                },
                "organicDirect": {
                    "spend": 0,
                    "revenue": 37029412,
                    "orders": 8719,
                    "visitors": 5604223,
                    "emailCaptures": 291391,
                    "emailConversions30Day": 0,
                    "emailConversions60Day": 0
                }
            },
            "totalMetrics": {
                "averageOrderValue": 3955
            }
        };
        
        async function loadMarketingData() {
            console.log('Marketing data loaded from embedded source');
            return marketingData;
        }

        // Helper functions to calculate email conversion rates
        function calculateEmailConversionRate(channel, timeWindow) {
            if (!marketingData) return 0;
            const channelData = marketingData.channelSummary[channel];
            if (!channelData) return 0;
            
            const conversions = timeWindow === 30 ? channelData.emailConversions30Day : channelData.emailConversions60Day;
            const captures = channelData.emailCaptures;
            
            return captures > 0 ? (conversions / captures) * 100 : 0;
        }

        function getChannelEmailData(channel) {
            if (!marketingData) return { captures: 0, conversions30: 0, conversions60: 0, visitors: 0 };
            const channelData = marketingData.channelSummary[channel];
            if (!channelData) return { captures: 0, conversions30: 0, conversions60: 0, visitors: 0 };
            
            return {
                captures: channelData.emailCaptures,
                conversions30: channelData.emailConversions30Day || 0,
                conversions60: channelData.emailConversions60Day || 0,
                visitors: channelData.visitors
            };
        }
        
        // Color palette
        const colors = {
            primary: '#3498DB',
            secondary: '#E74C3C',
            success: '#27AE60',
            warning: '#F39C12',
            muted: '#95A5A6',
            dark: '#2C3E50'
        };

        // Common chart options
        const commonOptions = {
            chart: {
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            }
        };

        // Revenue Trends Chart
        Highcharts.chart('revenue-trends-chart', {
            chart: {
                type: 'line',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Monthly Revenue Trends by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan-24', 'Feb-24', 'Mar-24', 'Apr-24', 'May-24', 'Jun-24', 
                           'Jul-24', 'Aug-24', 'Sep-24', 'Oct-24', 'Nov-24', 'Dec-24',
                           'Jan-25', 'Feb-25', 'Mar-25', 'Apr-25', 'May-25', 'Jun-25'],
                labels: { rotation: -45 }
            },
            yAxis: {
                title: { text: 'Revenue ($M)' },
                labels: {
                    formatter: function() {
                        return '$' + this.value.toFixed(1) + 'M';
                    }
                }
            },
            tooltip: {
                shared: true,
                valuePrefix: '$',
                valueSuffix: 'M',
                valueDecimals: 2
            },
            series: [{
                name: 'Google Ads',
                data: [1.28, 1.31, 1.97, 2.17, 4.42, 3.37, 3.16, 2.53, 2.35, 1.83, 3.30, 3.41, 2.25, 2.38, 1.87, 2.23, 3.93, 3.10],
                color: colors.primary
            }, {
                name: 'YouTube Ads',
                data: [0.003, 0.03, 0.01, 0.04, 0.09, 0.06, 0.09, 0.38, 0.11, 0.07, 0.15, 0.11, 0.08, 0.07, 0.24, 0.56, 1.74, 0.67],
                color: colors.warning
            }, {
                name: 'FB Ads',
                data: [0.08, 0.14, 0.25, 0.25, 0.57, 0.30, 0.20, 0.23, 0.27, 0.19, 0.64, 0.47, 0.27, 0.26, 0.45, 0.31, 0.90, 0.70],
                color: colors.secondary
            }, {
                name: 'Organic + Direct',
                data: [1.04, 0.99, 1.01, 1.26, 2.66, 1.82, 1.85, 2.20, 1.99, 1.87, 3.32, 3.36, 2.00, 2.02, 1.96, 1.83, 2.95, 2.91],
                color: colors.success,
                dashStyle: 'shortdot'
            }],
            plotOptions: {
                line: {
                    dataLabels: { enabled: false },
                    enableMouseTracking: true,
                    marker: { radius: 3 }
                }
            }
        });

        // Channel Comparison Chart
        Highcharts.chart('channel-comparison-chart', {
            chart: {
                type: 'column',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Channel Performance Comparison',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Google Ads', 'YouTube Ads', 'FB Ads', 'Organic + Direct']
            },
            yAxis: [{
                title: { text: 'ROAS', style: { color: colors.primary } },
                labels: { style: { color: colors.primary } }
            }, {
                title: { text: 'Conversion Rate (%)', style: { color: colors.success } },
                labels: { 
                    style: { color: colors.success },
                    formatter: function() {
                        return this.value + '%';
                    }
                },
                opposite: true
            }],
            tooltip: {
                shared: true
            },
            series: [{
                name: 'ROAS',
                data: [4.57, 1.98, 2.98, null],
                color: colors.primary,
                yAxis: 0,
                tooltip: { valueDecimals: 2, valuePrefix: '', valueSuffix: 'x' }
            }, {
                name: 'Conversion Rate',
                type: 'line',
                data: [0.66, 0.02, 0.08, 0.16],
                color: colors.success,
                yAxis: 1,
                marker: { radius: 5 },
                tooltip: { valueDecimals: 3, valueSuffix: '%' }
            }]
        });

        // Funnel Analysis Chart
        console.log('Creating funnel chart...');
        try {
        Highcharts.chart('funnel-analysis-chart', {
            chart: {
                type: 'funnel',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: {
                enabled: false
            },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: {
                text: 'Conversion Funnel by Channel',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            plotOptions: {
                series: {
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b> ({point.y:,.0f})',
                        softConnector: true
                    },
                    center: ['50%', '50%'],
                    neckWidth: '30%',
                    neckHeight: '25%',
                    width: '80%'
                }
            },
            series: [{
                name: 'Conversion Funnel',
                data: [
                    ['Total Visitors', 16958646],
                    ['Email Captures', 706515],
                    ['Add to Cart', 119899],
                    ['Orders Placed', 23980]
                ]
            }]
        });
        } catch (e) {
            console.error('Funnel chart error:', e);
        }

        // CAC Analysis Chart - REMOVED due to data quality issues
        console.log('Skipping CAC chart (removed due to data quality issues)');
        
        
        // Email Capture Rate Comparison Chart
        function createEmailCaptureChart() {
            console.log('Creating Email Capture Rate Comparison chart...');
            try {
                
                const youtubeData = getChannelEmailData('youtubeAds');
                const facebookData = getChannelEmailData('fbAds');
                const googleData = getChannelEmailData('googleAds');
                const organicData = getChannelEmailData('organicDirect');
                
                const youtubeCaptureRate = (youtubeData.captures / youtubeData.visitors * 100);
                const facebookCaptureRate = (facebookData.captures / facebookData.visitors * 100);
                const googleCaptureRate = (googleData.captures / googleData.visitors * 100);
                const organicCaptureRate = (organicData.captures / organicData.visitors * 100);
                
                console.log('Calculated capture rates:', {
                    youtube: youtubeCaptureRate,
                    facebook: facebookCaptureRate, 
                    google: googleCaptureRate,
                    organic: organicCaptureRate
                });

                Highcharts.chart('email-capture-comparison', {
                    chart: { 
                        type: 'column',
                        style: {
                            fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                        }
                    },
                    credits: { enabled: false },
                    exporting: {
                        buttons: {
                            contextButton: {
                                menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                            }
                        }
                    },
                    title: { 
                        text: 'Email Capture Rate Comparison by Channel',
                        style: { fontSize: '18px', fontWeight: '600' }
                    },
                    xAxis: {
                        categories: ['YouTube Ads', 'Facebook Ads', 'Google Ads', 'Organic/Direct'],
                        labels: { style: { fontSize: '12px' } }
                    },
                    yAxis: {
                        title: { 
                            text: 'Email Capture Rate (%)',
                            style: { fontSize: '12px' }
                        },
                        labels: {
                            formatter: function() {
                                return this.value + '%';
                            }
                        }
                    },
                    tooltip: {
                        pointFormatter: function() {
                            return '<b>' + this.y.toFixed(1) + '%</b> capture rate<br/>' +
                                   '<span style="color:#666;">(' + this.emails + ' emails from ' + this.visitors + ' visitors)</span>';
                        }
                    },
                    plotOptions: {
                        column: { 
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                formatter: function() {
                                    return this.y.toFixed(1) + '%<br/><span style="font-size:9px;color:#666;">(' + this.point.emails + ' emails)</span>';
                                },
                                useHTML: true,
                                style: { fontSize: '11px', fontWeight: 'bold' }
                            }
                        }
                    },
                    series: [{
                        name: 'Email Capture Rate',
                        data: [
                            { y: youtubeCaptureRate, color: '#E74C3C', emails: Math.round(youtubeData.captures/1000) + 'K', visitors: Math.round(youtubeData.visitors/1000000*10)/10 + 'M' },
                            { y: facebookCaptureRate, color: '#3498DB', emails: Math.round(facebookData.captures/1000) + 'K', visitors: Math.round(facebookData.visitors/1000000*10)/10 + 'M' },
                            { y: googleCaptureRate, color: '#27AE60', emails: Math.round(googleData.captures/1000) + 'K', visitors: Math.round(googleData.visitors/1000000*10)/10 + 'M' },
                            { y: organicCaptureRate, color: '#9B59B6', emails: Math.round(organicData.captures/1000) + 'K', visitors: Math.round(organicData.visitors/1000000*10)/10 + 'M' }
                        ],
                        showInLegend: false
                    }]
                });
            } catch (e) {
                console.error('Email Capture Rate Comparison chart error:', e);
            }
        }

        // Email Conversion Quality Chart
        function createEmailConversionChart() {
            console.log('Creating Email Conversion Quality chart...');
            try {
                
                const youtube30Day = calculateEmailConversionRate('youtubeAds', 30);
                const youtube60Day = calculateEmailConversionRate('youtubeAds', 60);
                const facebook30Day = calculateEmailConversionRate('fbAds', 30);
                const facebook60Day = calculateEmailConversionRate('fbAds', 60);
                const google30Day = calculateEmailConversionRate('googleAds', 30);
                const google60Day = calculateEmailConversionRate('googleAds', 60);
                const organic30Day = calculateEmailConversionRate('organicDirect', 30);
                const organic60Day = calculateEmailConversionRate('organicDirect', 60);

                Highcharts.chart('email-conversion-quality', {
                    chart: { 
                        type: 'bar',
                        style: {
                            fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                        }
                    },
                    credits: { enabled: false },
                    exporting: {
                        buttons: {
                            contextButton: {
                                menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                            }
                        }
                    },
                    title: { 
                        text: 'Email Conversion Patterns: 30-Day vs 60-Day Windows',
                        style: { fontSize: '18px', fontWeight: '600' }
                    },
                    xAxis: {
                        categories: ['YouTube Ads', 'Facebook Ads', 'Google Ads'],
                        labels: { style: { fontSize: '12px' } }
                    },
                    yAxis: {
                        title: { 
                            text: 'Email-to-Sale Conversion Rate (%)',
                            style: { fontSize: '12px' }
                        },
                        labels: {
                            formatter: function() {
                                return this.value + '%';
                            }
                        }
                    },
                    tooltip: {
                        valueSuffix: '% conversion rate'
                    },
                    plotOptions: {
                        series: {
                            dataLabels: {
                                enabled: true,
                                format: '{y:.2f}%',
                                style: { fontSize: '10px', fontWeight: 'bold' }
                            }
                        }
                    },
                    series: [{
                        name: '30-Day Conversion',
                        data: [youtube30Day, facebook30Day, google30Day],
                        color: 'rgba(52, 152, 219, 0.7)'
                    }, {
                        name: '60-Day Conversion', 
                        data: [youtube60Day, facebook60Day, google60Day],
                        color: 'rgba(52, 152, 219, 1.0)'
                    }]
                });
            } catch (e) {
                console.error('Email Conversion Quality chart error:', e);
            }
        }

        // Seasonality Heatmap
        console.log('Creating Seasonality Heatmap...');
        try {
        Highcharts.chart('seasonality-heatmap', {
            chart: { 
                type: 'heatmap',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: { enabled: false },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: { 
                text: 'Revenue Seasonality Pattern',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yAxis: {
                categories: ['2024', '2025'],
                title: null
            },
            colorAxis: {
                min: 0,
                max: 10,
                stops: [
                    [0, '#ffffff'],
                    [0.3, '#fef0d9'],
                    [0.5, '#fdcc8a'],
                    [0.7, '#fc8d59'],
                    [1, '#d7301f']
                ],
                labels: {
                    formatter: function() {
                        return '$' + this.value + 'M';
                    }
                }
            },
            legend: {
                align: 'right',
                layout: 'vertical',
                margin: 0,
                verticalAlign: 'middle',
                y: 25,
                symbolHeight: 200
            },
            tooltip: {
                formatter: function() {
                    return this.series.xAxis.categories[this.point.x] + ' ' +
                           this.series.yAxis.categories[this.point.y] + ': <b>$' +
                           this.point.value.toFixed(2) + 'M</b> revenue';
                }
            },
            series: [{
                name: 'Revenue',
                borderWidth: 1,
                borderColor: '#e0e0e0',
                data: [
                    // 2024
                    [0, 0, 2.4], [1, 0, 2.5], [2, 0, 3.2], [3, 0, 3.7], [4, 0, 7.7], [5, 0, 5.5],
                    [6, 0, 5.3], [7, 0, 5.3], [8, 0, 4.7], [9, 0, 4.0], [10, 0, 7.4], [11, 0, 7.4],
                    // 2025 (partial)
                    [0, 1, 4.6], [1, 1, 4.7], [2, 1, 4.5], [3, 1, 4.9], [4, 1, 9.5], [5, 1, 7.4]
                ],
                dataLabels: {
                    enabled: true,
                    format: '{point.value:.1f}M',
                    style: { color: '#000000' }
                }
            }]
        });
        } catch (e) {
            console.error('Seasonality Heatmap chart error:', e);
        }

        // Conversion Rate Seasonality
        console.log('Creating Conversion Rate Seasonality chart...');
        try {
        Highcharts.chart('conversion-seasonality', {
            chart: { 
                type: 'area',
                style: {
                    fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif'
                }
            },
            credits: { enabled: false },
            exporting: {
                buttons: {
                    contextButton: {
                        menuItems: ['downloadPNG', 'downloadJPEG', 'downloadPDF', 'downloadSVG']
                    }
                }
            },
            title: { 
                text: 'Conversion Rate Trends: 18-Month Analysis',
                style: { fontSize: '18px', fontWeight: '600' }
            },
            xAxis: {
                categories: ['Jan-24', 'Feb-24', 'Mar-24', 'Apr-24', 'May-24', 'Jun-24', 'Jul-24', 'Aug-24', 'Sep-24', 'Oct-24', 'Nov-24', 'Dec-24', 'Jan-25', 'Feb-25', 'Mar-25', 'Apr-25', 'May-25', 'Jun-25'],
                labels: { rotation: -45 }
            },
            yAxis: {
                title: { text: 'Conversion Rate (%)' },
                labels: {
                    formatter: function() {
                        return this.value + '%';
                    }
                }
            },
            tooltip: {
                valueSuffix: '%',
                valueDecimals: 3,
                shared: true
            },
            plotOptions: {
                area: {
                    stacking: null,
                    lineColor: '#666666',
                    lineWidth: 1,
                    fillOpacity: 0.3,
                    marker: { radius: 2 }
                }
            },
            series: [{
                name: 'Google Ads',
                data: [0.458, 0.709, 0.832, 1.060, 0.802, 0.780, 0.642, 0.675, 0.784, 0.859, 0.835, 1.050, 0.526, 0.657, 0.524, 0.563, 0.397, 0.417],
                color: colors.primary
            }, {
                name: 'FB Ads',
                data: [0.033, 0.039, 0.052, 0.047, 0.063, 0.101, 0.072, 0.025, 0.073, 0.063, 0.123, 0.129, 0.049, 0.033, 0.026, 0.030, 0.038, 0.023],
                color: colors.secondary
            }, {
                name: 'YouTube Ads',
                data: [0.003, 0.028, 0.009, 0.017, 0.010, 0.015, 0.012, 0.021, 0.014, 0.013, 0.006, 0.007, 0.006, 0.007, 0.019, 0.019, 0.025, 0.024],
                color: colors.warning
            }, {
                name: 'Organic + Direct',
                data: [0.154, 0.215, 0.201, 0.174, 0.175, 0.172, 0.121, 0.130, 0.120, 0.136, 0.278, 0.260, 0.129, 0.110, 0.160, 0.154, 0.119, 0.130],
                color: colors.success
            }]
        });
        } catch (e) {
            console.error('Conversion Rate Seasonality chart error:', e);
        }

        // Load marketing data on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, creating charts...');
            createEmailCaptureChart();
            createEmailConversionChart();
        });
    </script>
</body>
</html>